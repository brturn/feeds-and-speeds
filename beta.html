<!DOCTYPE html>
<html id="ALL" lang="en">
<!--
    COPYRIGHT 2015-2017, Bryan Turner
    ALL RIGHTS RESERVED

    This software is distributed under the GPL v3.
    A copy of the GPL v3 may be found at http://www.gnu.org/licenses/gpl.html

    Bugs, Suggestions, and PayPal donations to: bryan.turner@pobox.com
-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <title>Optimizing Feeds and Speeds Calculator for Milling</title>

    <style type="text/css">
        body  {padding: 20px;}
        li input {margin-bottom: 5px; padding: 2px 3px; width: 4em; float: right; }
        td    {padding: 4px; border: 1px black;}

        div.container {
            width: 100%;
            margin: 0px;
            border: 1px solid gray;
            line-height: 150%;
        }

        div.header, div.footer {
            padding: 0.5em;
            background-color: #CCCCCC;
            clear: left;
        }

        h1.header {
            padding: 0;
            margin: 0;
        }

        div.left {
            float: left;
            width: 160px;
            margin: 0;
            padding: 1em;
        }

        div.content {
            border-left: 1px solid gray;
            padding: 1em;
        }

        ul {
            float: left;
            width: 100%;
            padding: 0;
            margin: 0;
            list-style-type: none;
        }

        li {
            display: inline;

            float: left;
            width: 16em;
            height: 1.6em;
            text-decoration: none;
            padding: 0.2em 0.6em;
            border-right: 1px solid #CCCCCC;
        }

        .metric   .metric   { display: inline; }
        .metric   .imperial { display: none;   }
        .imperial .metric   { display: none;   }
        .imperial .imperial { display: inline; }

        div.results li { width: 16em; }
        div.results ul li ul li { width: 6.5em; border: none;}
    </style>
  </head>

<body role="document">
<div id="inputs" class="container imperial">
    <div class="header">
        <!-- Donation button -->
        <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
            <h2 class="header" style="display: inline;">Milling Speeds &amp; Feeds</h2>
            <input type="hidden" name="cmd" value="_s-xclick"/>
            <input type="hidden" name="hosted_button_id" value="UXF9L3E8TEVJA"/>
            <input type="image" style="float: none;" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="Donate!"/>
        </form>
        </br>
        <b>BETA - HSM Calculator, End Mill Render, Save &amp; Search Settings</b><br/>
        Please report any issues to <a href="mailto:bryan.turner@pobox.com">Bryan Turner</a><br/>
        </br>
        <a href="instructions.html">Instructions</a>
   </div>

    <hr/>
    <div>
    Search settings: <input id="search" onchange="updateSearch()" onkeyup="updateSearch()"><button disabled="true" id="load" onclick="loadSearch()">load</button><button disabled="true" id="delete" onclick="deleteSearch()">delete</button><br/>
    <span id="saved">Saved settings will appear here!</span>
    </div>
    <!-- ======================================== -->
    <div class="header"><b class="header">Machine</b> <input id="machine" value="Tormach 770"> <button id="machine" onclick="saveMachine()">save machine</button></div>
    <ul>
        <li><input type="checkbox" id="in_METRIC" onclick="convertAll()">Metric?</li>
    </ul>
    <ul>
        <li>RPM            <small>(min, max)</small>   <input id="max_RPM" value="10000">              <input id="min_RPM" value="1">    </li>
        <li>RPM at Peak Torque                         <input id="in_PEAK_TORQUE_RPM" value="5020">                                      </li>
        <!-- <li>Power Curve                                <input id="in_POWER_CURVE" value="{RPM: 0,Torque: 13,HP: 0},{RPM: 5020,Torque: 13,HP: 1},{RPM: 10000,Torque: 5.3,HP: 1}"></li> -->
    </ul>
    <ul>
        <li>Feed           <small class="imperial">in/min</small><small class="metric">mm/min</small>   <small>(min, max)</small>   <input id="max_IPM" value="135">   <input id="min_IPM" value="1">      </li>
        <li>Spindle Power  <small class="imperial">HP</small>    <small class="metric">KW</small>   <input id="max_HP" value="1"></li>
    </ul>

    <!-- ======================================== -->
    <div class="header"><b class="header">Tool</b> <input id="tool" value="3/8 HSS 3Fl"> <button id="tool" onclick="saveTool()">save tool</button></div>
    <ul>
        <li><select id="ux_E" onchange="uxPick('E')">
                <option value="HSS">High Speed Steel, 27-31</option>
                <option value="Carbide">Cemented Carbide, 75-91</option>
                <option value="CUSTOM">CUSTOM</option>
        </select></li>
<!--         <li>
            <select id="ux_COATING" onchange="uxPick('COATING')">
                <option value="1">Uncoated</option>
                <option value="1.1">TiN (gold) - general: steel, stainless, alloy, copper</option>
                <option value="1.3">TiCN (blue-gray) - use with coolant, abrasion resistant; Si-Aluminum, Titanium</option>
                <option value="1.3">TiAlN (violet-bronze) - dry; cast iron, hardened steel, super alloys</option>
                <option value="1.3">AlTiN (dark-gray / black) - dry; cast iron, hardened steel, super alloys</option>
                <option value="1.3">AlCrN (dark-gray) - Not recommended for Aluminum</option>
                <option value="1.3">CrN (silver) - Wood, aluminum, copper</option>
                <option value="1.3">ZrN (pale gold) - Aluminum, magnesium, titanium</option>
                <option value="1.2">TiCN (violet-brown) / TiB2 (pale gold) - use with coolant, abrasion resistant; Si-Aluminum, Titanium</option>
                <option value="1.2">PCD</option>
            </select>
        </li>
 -->
        <li>Modulus of Elasticity   <input id="in_E" value="27"> <small>(10^6 psi)</small></li>
        <li>#Teeth           <input id="in_TEETH" value="3"></li>
    </ul>
    <ul>
        <li>Shank Diameter   <small class="imperial">inch</small><small class="metric">mm</small><input id="in_SHANK" value="0.375"></li>
        <li>Flute Diameter   <small class="imperial">inch</small><small class="metric">mm</small><input id="in_DIAMETER" value="0.375"></li>
        <!-- <li>Tip Diameter     <small class="imperial">inch</small><small class="metric">mm</small><input id="in_TIP" value="0.375"></li> -->
    </ul>
    <ul>
        <li>Total Stickout   <small class="imperial">inch</small><small class="metric">mm</small><input id="in_L" value="0.9"></li>
        <li>Fluted Length    <small class="imperial">inch</small><small class="metric">mm</small><input id="in_FL" value="0.75"></li>
    </ul>
    <ul>
    </ul>
    <!-- <ul> -->
        <!-- <li>Corner Radius    <small class="imperial">inch</small><small class="metric">mm</small><input id="in_CORNER" value="0.0"></li> -->
        <!-- <li>Lead Angle       <input id="in_LEAD" value="90"></li> -->
        <!-- <li>Helix Angle      <input id="in_HELIX" value="30"></li> -->
    <!-- </ul> -->

    <!-- ======================================== -->
    <div class="header"><b class="header">Cut</b> <input id="cut" value="n/a"> <button id="cut" onclick="saveCut()">save cut</button></div>
    <ul>
        <li><select id="ux_OPR" onchange="uxPick('OPR')">
                <option value="slot">Slotting / Ramping</option>
                <option value="profile">Profiling</option>
                <option value="hsm">HSM - Constant Engagement</option>
                <option value="drill">Drilling / Plunging</option>
        </select></li>
    </ul>
    <ul>
        <li>
            <select id="ux_UNITPOWER" onchange="uxPick('UNITPOWER')">
              <option value="Aluminum">Aluminum</option>
              <option value="Copper">Copper/Brass/Bronze</option>
              <option value="Iron">Iron</option>
              <option value="Steel">Steel</option>
              <option value="Stainless">Stainless Steel</option>
              <option value="Titanium">Titanium</option>
              <option value="Plastic">Plastic</option>
              <option value="Wood">Wood</option>
              <option value="CUSTOM">CUSTOM</option>
            </select>
        </li>
        <li>Unit Power  <small>HP/in^3</small> <input id="in_UNITPOWER" value="0.33"></li>
    </ul>
    <ul>
        <li>DOC   <small class="imperial">inch</small><small class="metric">mm</small>      <small>(min, max)</small>   <input id="max_DOC" value="0.75">           <input id="min_DOC" value="0.01"></li>
        <li>WOC   <small class="imperial">inch</small><small class="metric">mm</small>      <small>(min, max)</small>   <input id="max_WOC" value="0.375">          <input id="min_WOC" value="0.01"></li>
    </ul>
    <ul>    
        <li><span class="imperial">SFM</span><span class="metric">SMM</span>            <small>(min, max)</small><input id="max_SFM" value="600">        <input id="min_SFM" value="1"></li>
        <li>Chipload <small class="imperial">in</small><small class="metric">mm</small> <small>(min, max)</small><input id="max_CHIPLOAD" value="0.0023"><input id="min_CHIPLOAD" value="0.0008"></li>
    </ul>
    <!-- ======================================== -->
    <div class="header"><b class="header">Constraints</b> </div>
    <ul>
        <li>Max Deflection <small class="imperial">inch</small><small class="metric">mm</small> <input id="max_DEFLECTION" value="0.001"></li>
        <li>Max Torque <small class="imperial">in-lbs</small><small class="metric">Nm</small><input id="max_TORQUE" value="99999"></li>
    </ul>
    <ul>
        <li>Max Radial Force <small class="imperial">lbs</small><small class="metric">Kg</small><input id="max_P" value="99999"></li>
        <li>Max Axial Force <small class="imperial">lbs</small><small class="metric">Kg</small><input id="max_PAxial" value="99999"></li>
    </ul>
<!--     <ul>
        <li>Helical Radius <small class="imperial">inch</small><small class="metric">mm</small>  <input id="in_HELICAL" value="0"></li>
        <li>Plunge Angle <small>deg.</small>  <input id="in_PLUNGE" value="0"></li>
    </ul>
    <ul>
        <li>Min Corner Radius <small class="imperial">inch</small><small class="metric">mm</small>  <input id="in_HELICAL" value="0"></li>
        <li>Min Corner Angle <small class="imperial">inch</small><small class="metric">mm</small>  <input id="in_ANGLE" value="TODO"></li>
    </ul>
 -->

    <!-- BETA - not debugged yet -->
    <input id="in_HELICAL" type="hidden" value="0">
    <input id="in_ANGLE"   type="hidden" value="0">
    <input id="in_CORNER"  type="hidden" value="0.0">
    <input id="in_LEAD"    type="hidden" value="90">
    <input id="in_HELIX"   type="hidden" value="30">

    <!-- ======================================== -->
    <div class="header"><b class="header">RESULTS</b>
        <button onclick="new_compute()">Compute</button>
        <a id="CURRENT" href="">[Bookmark this link to save these parameters]</a>
        <span id="MEMO" style="color:red">This is a memo.</span>
    </div>
    <div id="OUT" class="results">
        <ul>
            <li><ul><li><b>RPM</b>   </li><li id="RPM"    style="font-weight: bold;"/></ul></li>
            <li><ul><li><b>Feed</b>  <small class="imperial">in/min</small><small class="metric">mm/min</small></li><li id="IPM"    style="font-weight: bold;"/></ul></li>
            <!-- <li><ul><li><b>Plunge</b></li><li id="PLUNGE" style="font-weight: bold;"/></ul></li> -->
        </ul>
        <ul>
            <li><ul><li>DOC <small class="imperial">inch</small><small class="metric">mm</small></li><li id="DOC"/></ul></li>
            <li><ul><li>WOC <small class="imperial">inch</small><small class="metric">mm</small></li><li id="WOC"/></ul></li>
            <li><ul><li><span class="imperial">SFM</span><span class="metric">SMM</span> </li><li id="SFM"/></ul></li>
        </ul>

        <!-- ======================================== -->
        <div class="header"><b class="header">ADVANCED</b></div>
        <ul>
            <li><ul><li>MRR        <small class="imperial">in^3/min</small><small class="metric">cm^3/min</small></li><li id="MRR"/></ul></li>
            <li><ul><li>Cut Power  <small class="imperial">HP</small><small class="metric">KW</small></li><li id="HP"/></ul></li>
        </ul>
        <ul>
            <li><ul><li>Deflect    <small class="imperial">in</small><small class="metric">mm</small></li><li id="DEFLECTION"/></ul></li>
            <li><ul><li>Mx.Deflect <small class="imperial">in</small><small class="metric">mm</small></li><li id="MAX_DEFLECTION"/></ul></li>
        </ul>
        <ul>
            <li><ul><li>Torque     <small class="imperial">in-lbs</small><small class="metric">Nm</small> </li><li id="TORQUE"/></ul></li>
            <li><ul><li>Tq.Avail.  <small class="imperial">in-lbs</small><small class="metric">Nm</small> </li><li id="AVAIL"/></ul></li>
            <li><ul><li>Break Tq.  <small class="imperial">in-lbs</small><small class="metric">Nm</small></li><li id="TWIST"/></ul>
        </ul>
        <ul>
            <li><ul><li>Radial Force <small class="imperial">lbs</small><small class="metric">kg</small></li><li id="P"/></ul></li>
            <li><ul><li>Axial Force  <small class="imperial">lbs</small><small class="metric">kg</small></li><li id="PAxial"/></ul></li>
            <li><ul><li>Radial Break <small class="imperial">lbs</small><small class="metric">kg</small></li><li id="BEND"/></ul></li></li>
        </ul>
        <ul>
            <li><ul><li>Chipload   <small class="imperial">inch</small><small class="metric">mm</small></li><li id="CHIPLOAD"/></ul></li>
            <li><ul><li>APT        <small class="imperial">inch</small><small class="metric">mm</small></li><li id="AdjIPT"/></ul></li>
        </ul>
        <ul>
            <li><ul><li>Eff. Diam. <small class="imperial">inch</small><small class="metric">mm</small></li><li id="EFFECTIVE"/></ul></li>
            <li><ul><li>TEA  <small>(deg.)</small> </li><li id="TEA"/></ul></li>
        </ul>
        <ul>
            <li><ul><li>Chip Factor </li><li id="CHIPFACTOR"/></ul></li>
            <li><ul><li>SFM  Factor </li><li id="SFMFACTOR"/></ul></li>
            <li><ul><li>Feed Factor </li><li id="FCF"/></ul></li>
        </ul>
    </div>

    <div class="header"><b class="header">End Mill Profile</b></div>
        <canvas id="profile">
            <div id="fallback">
                Sorry, your browser does not support canvas.  Preview feature will not work.
            </div>
        </canvas>
    </div>

    <!-- <div class="header"><b class="header">Radial Engagement</b></div>
        <canvas id="radial">
            <div>
                Sorry, your browser does not support canvas.  Preview feature will not work.
            </div>
        </canvas>
    </div>

    <div class="header"><b class="header">Parameter Variations</b></div>
    <table id="ALTERNATIVES" class="content"></table>
    <div>
        <div id="chart_div" style="width: 900px; height: 500px;"></div>
        <div id="chart_div2" style="width: 900px; height: 500px;"></div>
    </div> -->

  <div class="footer">Copyright 2015-2017 by Bryan Turner, All Rights Reserved</div>
</div>    

<script type="text/javascript">

    var Modulus = {}
    Modulus.HSS = 27;
    Modulus.Carbide = 75;

    var cutParameters = {}
    // HSS cut parameters roughly taken from:
    //    Machinery's Handbook 29 (2012) pp1083-1084
    cutParameters.HSS = {};
    cutParameters.HSS.Aluminum  = [600, 160]    // SFM, then Chipload as (DIAMETER / XXX)]
    cutParameters.HSS.Copper    = [250, 160]    // ie:  [250, 160] ==> SFM = 250, Chipload = DIAMETER / 160
    cutParameters.HSS.Iron      = [80, 200]
    cutParameters.HSS.Steel     = [60, 250]
    cutParameters.HSS.Stainless = [70, 200]
    cutParameters.HSS.Titanium  = [70, 200]
    cutParameters.HSS.Plastic   = [500, 125]
    cutParameters.HSS.Wood      = [800, 100]

    // Carbide parameters roughly taken from:
    //    http://robbjack.com/technical/speed-and-feed
    cutParameters.Carbide = {};
    cutParameters.Carbide.Aluminum  = [1500, 80]
    cutParameters.Carbide.Copper    = [600, 80]
    cutParameters.Carbide.Iron      = [400, 100]
    cutParameters.Carbide.Steel     = [260, 300]
    cutParameters.Carbide.Stainless = [225, 200]
    cutParameters.Carbide.Titanium  = [110, 250]
    cutParameters.Carbide.Plastic   = [1300, 40]
    cutParameters.Carbide.Wood      = [1300, 80]

    // HSS cut parameters roughly taken from:
    //    Machinery's Handbook 29 (2012) pp1083-1084
    var unitPower = {};
    unitPower.Aluminum = 0.33
    unitPower.Copper = 0.80;
    unitPower.Iron = 0.85;
    unitPower.Steel = 1.00;
    unitPower.Stainless = 0.80;
    unitPower.Titanium = 0.80;  // 1.2?
    unitPower.Plastic = 0.20;
    unitPower.Wood = 0.20;



    // ------------------------------------------------------------------------------
    // Milling Speeds & Feeds Calculator
    // by Bryan Turner, 2015-2016
    // All rights reserved.

    var OneHP = 33000;         // (lb-ft) per minute
    var InchesPerFoot = 12;
    var PI = Math.PI;

    // Metric Input Conversions (reverse for output)
    var SMMtoSFM     = 3.28084;     // SMM -> SFM
    var mmToInch     = 0.03937;     // mm -> Inch
    var KWToHP       = 1.34102;     // KW -> HP
    var KWcm3ToHPin3 = 21.9754;     // KW/cm^3 -> HP/in^3
    var NMtoInLbs    = 8.85075;     // Nm -> In-Pounds
    var GPtoPSI6     = 0.14503;     // GigaPascals -> PSI*10^6
    var cm3ToIn3     = 0.06102;
    var KGtoLbs      = 2.20462;

    var useMetric    = false;
    var operation    = "slot";

    var ridx        = 0;
    var tryCounter  = 0;
    var constants   = {};
    var parameters  = {};
    var results     = [];

    var METRIC      =        constant ('METRIC',  false,true,1);

    var SLOTTING_SFM_MULTIPLIER  = 0.83; // WIDIA: 90% SFM for slotting minus ~10% which is added back in our interpolation equation.
    var HSM_SFM_MULTIPLIER       = 4.0;  // WIDIA
    var SLOTTING_CHIP_MULTIPLIER = 0.73; // WIDIA: 80% chipload for slotting minus ~10% which is added back in our interpolation equation.
    var HSM_CHIP_MULTIPLIER      = 4.4;  // WIDIA

    var MAX_RESULTS = 20;  // How many bubbles to display?

    // ---------------------------------------------------------
    // Define the parameters & constants for the optimizer
    //                                 Name            Digits   Min     Max    Metric->Imperial
    var L           =        constant ('L',                 2,  0.01,   10,    mmToInch);
    var FL          =        constant ('FL',                2,  0.01,   10,    mmToInch);
    var TEETH       =        constant ('TEETH',             0,  1,      99,    1);
    var UNITPOWER   =        constant ('UNITPOWER',         4,  0.01,   10,    1);              // HP / cu.in. -- No Metric for now
    var E           =        constant ('E',                 2,  0.01,   999,   1);              // Modulus of Elasticity (pounds per sq. inch -- No metric for now)
    var PEAK_TQ_RPM =        constant ('PEAK_TORQUE_RPM',   0,  1,      99999, 1);              // RPM at which we reach peak Torque
    var SHANK       =        constant ('SHANK',             4,  0.0001, 99,    mmToInch);
    var DIAMETER    =        constant ('DIAMETER',          4,  0.0001, 99,    mmToInch);
    // var HELIX       =        constant ('HELIX',             0,  0,      90,    1);
    var LEAD        =        constant ('LEAD',              0,  0,      90,    1);
    var CORNER      =        constant ('CORNER',            0,  0,      99,    mmToInch);
    var TIP         =        constant ('TIP',               4,  0,      99,    mmToInch);
    var HELICAL     =        constant ('HELICAL',           4,  0,      99,    mmToInch);

    var AvailableTorque           = constant ('AVAIL',      2,  0,      9999,  NMtoInLbs);
    // var PlungeIPM                 = constant ('PLUNGE',     1,  0,      9999,  mmToInch);
    var EffectiveDiameter         = constant ('EFFECTIVE',  4,  0,      9999,  mmToInch);
    var AxialChipThinningFactor   = constant ('ACTF',       2,  0,      1,     1);
    var RadialChipThinningFactor  = constant ('RCTF',       2,  0,      1,     1);
    var FeedCorrectionFactor      = constant ('FCF',        2,  0,      1,     1);
    var ToolEngagementAngle       = constant ('TEA',        0,  0,      180,   1);

    var RPM         =        parameter('RPM',               0,  1,      99999, 1);
    var AdjustedIPT =        parameter('AdjIPT',            4,  0.0001, 0.5,   mmToInch);       // Should setup with same values as chipload
    var IPM         =        parameter('IPM',               1,  0.1,    9999,  mmToInch);
    var MRR         =        parameter('MRR',               2,  0.01,   999,   cm3ToIn3);
    var HP          =        parameter('HP',                2,  0.01,   999,   KWToHP);
    var TORQUE      =        parameter('TORQUE',            2,  0.01,   9999,  NMtoInLbs);
    var P           =        parameter('P',                 2,  0.01,   9999,  KGtoLbs);        // Radial cutting force (lbs)
    var PAxial      =        parameter('PAxial',            2,  0.01,   9999,  KGtoLbs);        // Axial cutting force (lbs)
    var DEFLECTION  =        parameter('DEFLECTION',        5,  0,      0.01,  mmToInch);
    var SFM         =        parameter('SFM',               0,  1,      9999,  SMMtoSFM);
    var CHIPLOAD    =        parameter('CHIPLOAD',          4,  0.0001, 0.5,   mmToInch);       // Actual chipload
    var WOC         =        parameter('WOC',               3,  0.001,  99,    mmToInch);       // Width of Cut (radial engagement)
    var DOC         =        parameter('DOC',               3,  0.001,  99,    mmToInch);       // Depth of Cut (axial engagement)

    // TESTING
    var BEND        =        constant('BEND',               2,  0.01,   9999,  NMtoInLbs);
    var TWIST       =        constant('TWIST',              2,  0.01,   9999,  NMtoInLbs);
    var CHIPFACTOR  =        constant('CHIPFACTOR',         2,  0.01,   9999,  mmToInch);
    var SFMFACTOR   =        constant('SFMFACTOR',          2,  0.01,   9999,  SMMtoSFM);
    var MXDEFLECTION=        parameter('MAX_DEFLECTION',    5,  0,      0.01,  mmToInch);

//    function trim_precision(v) { return Number(Number(v.toPrecision(4)).toFixed(5)); }
    function trim_precision(v) { return Number(Number(v.toPrecision(4))); }

    var JUNKprint = false;

    // https://en.wikipedia.org/wiki/Deflection_(engineering)
    function cantileverDeflectEndLoad(F,L,E,I) { return     F*Math.pow(L,3) / (3*E*I); }
    function cantileverDeflectUniLoad(F,L,E,I) { return (F/L)*Math.pow(L,4) / (8*E*I); }

    function toolEngagementAngle( woc, diameter) { return toDegrees( Math.acos( 1 - ((2 * woc) / diameter))) } // SANDVIK

    // KENNAMETAL
    function brinell3000ToPSI(HB)                { return 500 * HB; }
    function brinell500ToPSI(HB)                 { return 1.15 * brinell3000ToPSI(HB); }
    function teethInCut( diameter, woc, teeth )  { return teeth * toolEngagementAngle(woc,diameter) / 360; }
    function tangentialForceLbs( materialUltimateTensilePSI, chipArea, teethInCut, machinability, toolWear ){ return materialUltimateTensilePSI * chipArea * teethInCut * machinability * toolWear; }
    function tangentialToTorque(tangentialForceLbs, diameter)  { return tangentialForceLbs * (diameter / 2); }
    function tangentialToHp( tangentialForceLbs, sfm )         { return (tangentialForceLbs * sfm) / OneHP; }

    function helicalRadialWOC(roughDia, finalDia, diameter)   // Rough/Final diameter of circular hole.
    {
        var cutDia = finalDia + diameter;

        // Rough < Finished == Internal Interpolation
        if ( roughDia < finalDia )
            cutDia = finalDia - diameter;

        return Math.abs((Math.pow(finalDia, 2) - Math.pow(roughDia, 2)) / (4 * cutDia));
    }

    function helicalFeedRateCenterline(roughDia, finalDia, diameter, ipm)   // Rough/Final diameter of circular hole.
    {
        // Rough < Finished == Internal Interpolation
        if (roughDia < finalDia)
            return (ipm * (finalDia - diameter)) / finalDia;
        else
            return (ipm * (finalDia + diameter)) / finalDia;
    }

    // function machineRPMtoPower(rpm,powerCurve)
    // {
    //     // ASSUME: Power curve is sorted by RPM
    //     var prev = powerCurve[0];
    //     for ( var i = 0; i < powerCurve.length; i++ )
    //     {
    //         var cur = powerCurve[i];
    //         if ( rpm <= cur.RPM ) return [prev,cur];
    //     }

    //     return [{0,0},{0,0}];
    // }

    // function machineRPMtoAvailableTorque(rpm,powerCurve)
    // {
    //     var power = machineRPMtoPower(rpm,powerCurve);
    //     var prev  = power[0];
    //     var cur   = power[1];

    //     // Linear interpolation between prev and cur
    //     var scale = (rpm - prev.RPM) / Math.min(0.001, cur.RPM - prev.RPM);
    //     return prev.Torque + scale * (cur.Torque - prev.Torque);
    // }

    // function machineRPMtoAvailableHP(rpm,powerCurve)
    // {
    //     var power = machineRPMtoPower(rpm,powerCurve);
    //     var prev  = power[0];
    //     var cur   = power[1];
        
    //     // Linear interpolation between prev and cur
    //     var scale = (rpm - prev.RPM) / Math.min(0.001, cur.RPM - prev.RPM);
    //     return prev.HP + scale * (cur.HP - prev.HP);
    // }


    // TESTING
    var pix  = null;
    var SIZE = 501;  // One extra row/column to simplify the update logic
    var area = Array(SIZE);
    var effDiameter  = Array(500);
    for ( var i = 0; i < SIZE; i++ )
    {
        area[i] = Array(SIZE);
        for ( var j = 0; j < SIZE; j++ )
            area[i][j] = 0;
    }

    // TESTING
    var originalSFM      = 0;
    var originalCHIPLOAD = 0;

    function finalize()
    {
        reset_limits(parameters);

        // Parameters selected by the optimizer..
        SFM.v      = trim_precision(SFM.v);
        CHIPLOAD.v = trim_precision(CHIPLOAD.v);
        WOC.v      = trim_precision(WOC.v);
        DOC.v      = trim_precision(DOC.v);

        // --------------------------------------------------------------------------------
        // Equations from:
        //
        // INGERSOLL  - http://www.ingersoll-imc.com/en/products/ingersoll_cat-009_technical.pdf
        // WIDIA      - https://www.widia.com/content/dam/kennametal/widia/common/resources/downloads/literature/WIDIA%20Catalogs/A-14-04126_WID_Trochoidal_SEM_EN_Metric.pdf
        // SANDVIK    - http://www.sandvik.coromant.com/en-us/knowledge/milling/formulas_and_definitions/formulas/pages/default.aspx
        // SECO       - http://www.moldmakingtechnology.com/articles/special-feature-education-training-tailored-training-is-the-best-way-to-build-effective-manufacturing-teams
        // KENNAMETAL - https://www1.mscdirect.com/images/solutions/kennametal/millingTechInfoFormulas.pdf


        // TODO: Drilling
        // ------------------------
        // WOC / DOC -- irrelivent?
        // IPM = chipload * rpm
        // MRR = area of drill * IPM
        // Radial Force = 0 ?
        // No Helical Interpolation

        // TODO: Turning
        // ------------------------
        // DIAMETER = workpiece diameter
        // TEETH = 1
        // CHIPLOAD? = ?    radial depth?
        // DOC? = ?         irrelivent?
        // WOC? = ?         IPR?
        // MRR = (chipload * rpm) * DOC * Diameter
        // Radial Force = 0 ?
        // No Helical Interpolation

        // --------------------------------
        // Scale some of the user values..

        var local_E          = E.v * 1000000;                                // Scale modulus of elasticity
        var local_UNITPOWER  = UNITPOWER.v;

        // --------------------------------------------------------------------------------
        // Constants derived from user inputs
        var MAX_TORQUE       = trim_precision((HP.max * OneHP * InchesPerFoot) / (2 * Math.PI * PEAK_TQ_RPM.v));

        // --------------------------------------------
        // Helical Interpolation
        // - Adjust WOC and IPM
        //
        var helicalIPM = 1;
        // if ( operation != "slot" && operation != "drill" )
        // {
        //     var helicalWOC = WOC.v;
        //     if ( HELICAL.v > 0 )
        //     {
        //         helicalWOC = helicalRadialWOC(          HELICAL.v - 2*WOC.v, HELICAL.v, DIAMETER.v);
        //         helicalIPM = helicalFeedRateCenterline( HELICAL.v - 2*WOC.v, HELICAL.v, DIAMETER.v, 1)
        //         console.info( "Internal Helical WOC = ", helicalWOC );
        //         console.info( "Internal Helical IPM = ", helicalIPM );
        //     }
        //     else if ( HELICAL.v < 0 )
        //     {
        //         helicalWOC = helicalRadialWOC(          (-HELICAL.v) + 2*WOC.v, HELICAL.v, DIAMETER.v);
        //         helicalIPM = helicalFeedRateCenterline( (-HELICAL.v) + 2*WOC.v, HELICAL.v, DIAMETER.v, 1);
        //         console.info( "External Helical WOC = ", helicalWOC );
        //         console.info( "External Helical IPM = ", helicalIPM );
        //     }

        //     WOC.v = helicalWOC;
        // }

        // --------------------------------
        // Calculate actual MRR and Effective Diameter for arbitrary end mill geometry!
        //
        // - Generate a bitmap containing the tool profile
        // - Double-integration over the limits implied by the WOC, DOC, and tool profile
        // - Slotting vs profiling (slotting is 'centered' on the tool)
        //
        // Coordinates:
        //  (0,0) is centerline of tool, at the spindle nose.
        //  +X is to the right
        //  +Y is down (away from spindle)
        //

        var overlap = 0;
        if ( operation == "drill")
        {
            overlap = PI * Math.pow(DIAMETER.v/2,2);
            EffectiveDiameter.v = DIAMETER.v;
            TEETH.v = 1;
        }
        else if ( CORNER.v != 0 || LEAD.v != 90 )
        {
            // Select appropriate integration limits
            var size  = 500;
            var scale = size / Math.max(DIAMETER.v, Math.max(SHANK.v, L.v));
            var pixelArea = 1 / (scale * scale);

            var lowX;
            if ( operation == "slot" ) lowX = -DIAMETER.v/2;             // Ignore WOC when slotting...
            else                       lowX =  DIAMETER.v/2 - WOC.v;
            var lowY = L.v - DOC.v;

            lowX = Math.max( 0, Math.floor( lowX * scale ) + size/2);
            lowY = Math.floor( lowY * scale );

            overlap = area[lowX][lowY];
            EffectiveDiameter.v = effDiameter[lowY];
        }
        else // Square end mill
        {
            EffectiveDiameter.v = DIAMETER.v;
            if ( operation == "slot" )
                overlap = EffectiveDiameter.v * DOC.v;
            else
                overlap = WOC.v * DOC.v;
        }

        // When slotting/drilling, WOC is fixed.
        if ( operation == "slot" || operation == "drill" )
        {
            WOC.v     = EffectiveDiameter.v;
            WOC.max   = EffectiveDiameter.v;
            WOC.limit = EffectiveDiameter.v;
        }

        // --------------------------------------------------------------------------------
        // Tool Engagement Angle (straight shoulder along a straight path)
        //    TODO: Check that this works for slotting, helical, etc..
        //
        if ( operation == "drill" )
            ToolEngagementAngle.v = 360;
        else
            ToolEngagementAngle.v = toolEngagementAngle(WOC.v, EffectiveDiameter.v);

        // --------------------------------
        if ( operation == "hsm" )
        {
            // ASSUME: LEAD angle is angle between the workpiece and the cutting edge  (flutes parallel to axis = 90-degree lead)
            // ASSUME: Helix angle is angle between the axis of the tool to the slope of the helical flutes.  Flutes parallel to axis = 0-degree helix
            var RadialEngagement = WOC.v / EffectiveDiameter.v;       // SANDVIK
            var fzRadial       = 1 / Math.sqrt(RadialEngagement);     // WIDIA -- This is an approximation of average chip thickness.  Nice because it is 1.0 at full-slot, and valid through the entire range.

            // WIDIA : SFM & Chipload Multipliers for HSM
            //
            // SFM Multiplier:             Full Slot = 0.9, 50% WOC = 1, 40% WOC = 1.1, 30% = 1.2, 20% = 1.3, 10% = 1.4, 5% = 2.5, 4% = 3, 2% = 4
            // Feed(chipload?) Multiplier: Full Slot = 0.9, 50% WOC = 1, 40% WOC = 1,   30% = 1.1, 20% = 1.4, 10% = 2.0, 5% = 2.5, 4% = 3, 2% = 4.4
            //   (but WIDIA also says reduce chipload by 20% for full slot.. I'm choosing 0.8 for slotting chipload)

            // Compute the HSM factors
            // Equations designed by Bryan Turner (based on WIDIA suggested multipliers for SFM & Chipload)
            SFMFACTOR.v  = SLOTTING_SFM_MULTIPLIER  + (HSM_SFM_MULTIPLIER  - SLOTTING_SFM_MULTIPLIER)  / (RadialEngagement * 50); 
            CHIPFACTOR.v = SLOTTING_CHIP_MULTIPLIER + (HSM_CHIP_MULTIPLIER - SLOTTING_CHIP_MULTIPLIER) / (RadialEngagement * 50); 

            SFM.limit      = originalSFM      * SFMFACTOR.v;
            CHIPLOAD.limit = originalCHIPLOAD * CHIPFACTOR.v;

            // --------------------------------
            // Radial chip thinning: Use WOC & effective diameter
            //
            RadialChipThinningFactor.v = trim_precision(fzRadial);

            // --------------------------------
            // Axial chip thinning: Use DOC & corner-radius
            //
            if ( CORNER.v > 0 && DOC.v < CORNER.v )
                // TODO: This factor is for BALLNOSE end mills -- check that it is valid for corner-rounded end mills.
                AxialChipThinningFactor.v  = trim_precision( 1 / Math.sqrt(1 - Math.pow(1 - (DOC.v/CORNER.v),2)));
            else if ( LEAD.v != 90 && LEAD.v != 0 )
                // ASSUME: LEAD angle is angle between the cutting edge and the workpiece (straight end-mill = 90-degree lead)
                AxialChipThinningFactor.v = trim_precision( 1 / (Math.cos(toRadians(LEAD.v)) * Math.tan(toRadians(LEAD.v))));
            else
                AxialChipThinningFactor.v = 1;
        }
        else
        {
            AxialChipThinningFactor.v  = 1;
            RadialChipThinningFactor.v = 1;
            SFMFACTOR.v  = 1;
            CHIPFACTOR.v = 1;
        }

        // Adjust chipload up to max multipler based on how thin the chips are
        FeedCorrectionFactor.v = trim_precision(AxialChipThinningFactor.v * RadialChipThinningFactor.v * helicalIPM);

        // -----------------------------------
        // INGERSOLL Cutting Tools - LEAD angle adjustment to deflection force
        // "As depth of cut decreases, a greater proportion of the cutting force is exerted in the axial direction."
        // http://www.mmsonline.com/articles/the-high-feed-high-reliability-process
        // -- Basically, the force is acting on the rake of the axial cutting edges rather than the radial cutting edges.
        // -- Works for lead-angle and corner-round endmills at low DOC
        //
        // Equation designed by Bryan Turner
        //    X component of unit normal of DOC/WOC slope, limited to WOC <= RADIUS
        //    Scaled by radial engagement (light radial loads for HSM)
        //    Scaled by helix angle (higher axial loads for high helix cutters)
        var HELIX = 30;
        var radialFactor;
        var axialFactor;
        if ( operation == "drill" )
        {
            radialFactor = 0;
            axialFactor  = 1;
        }
        else
        {
            // Not quite correct .. radial/axial forces will not generally add up to 100% of spindle power, rather they have oblique force-multipliers due to lever/fulcrum effects.
            // For now just make them balance.
            radialFactor = Math.min( 1,
                           Math.cos( Math.atan( Math.min(WOC.v,EffectiveDiameter.v/2) / DOC.v) ) *  // Angle of cutter engagement (deep thin slot = 1.0)
                           Math.sqrt(WOC.v / EffectiveDiameter.v) *                                 // Scale by radial engagement
                           Math.cos(toRadians(HELIX)));                                             // Scale by Helix angle

            axialFactor  = 1 - radialFactor;
        }

        // -----------------------------------
        // The "classic" equations, in dependency order, assuming we have selected DOC, WOC, SFM, and CHIPLOAD:
        //
        RPM.v          = trim_precision((SFM.v * InchesPerFoot) / (EffectiveDiameter.v * PI));
        AdjustedIPT.v  = trim_precision(CHIPLOAD.v * FeedCorrectionFactor.v);
        IPM.v          = trim_precision(AdjustedIPT.v * TEETH.v * RPM.v);
        MRR.v          = trim_precision(IPM.v * overlap);               // NOTE: Using ACTUAL overlap between workpiece and tool for MRR calculation.

        HP.v           = trim_precision(MRR.v * local_UNITPOWER);
        TORQUE.v       = trim_precision((HP.v * OneHP * InchesPerFoot) / (2 * PI * RPM.v));
        P.v            = trim_precision((radialFactor * HP.v * OneHP) / SFM.v);        // Force acting to bend the end mill..
        PAxial.v       = trim_precision((axialFactor  * HP.v * OneHP) / SFM.v);        // Force acting to pull the end mill out of the tool holder (or the workpiece off the table)..

        // How much torque is available at this RPM?
        // TODO: More advanced torque curve: lookup table with linear approximation between entries
        AvailableTorque.v = trim_precision(Math.min(1,RPM.v / PEAK_TQ_RPM.v) * MAX_TORQUE);
        TORQUE.limit      = Math.min( AvailableTorque.v, TORQUE.limit);

        // ï¿¼--------------------------
        // Deflection (multi-part bar)
        // FROM: Metal Cutting Theory and Practice, By David A. Stephenson, John S. Agapiou, p362
        // FROM: "Structural modeling of end mills for form error and stability analysis", E.B. Kivanc, E. Budak

        // Moment of Inertia: This is the equation for a SOLID round beam - the shank of the end mill
        // https://en.wikipedia.org/wiki/List_of_area_moments_of_inertia
        var IS = (PI * Math.pow(SHANK.v/2,4)) / 4;

        // Estimated equivelent solid diameter of fluted portion = 80% of fluted diameter
        // "Determination of the Equivalent Diameter of an End Mill Based on its Compliance", L. Kops, D.T. Vo
        var IF = (PI * Math.pow((DIAMETER.v*0.8)/2,4)) / 4;

        var LS  = L.v - FL.v;       // Length of shank portion
        var LFu = FL.v - DOC.v;     // Length of non-cutting flute portion
        var LFc = DOC.v;            // Length of flute portion in cut

        if ( operation == "drill" )
            DEFLECTION.v = 0;
        else
        {
            var deflectionShank      = cantileverDeflectEndLoad(P.v,LS ,local_E,IS);    // Point load @ end of shank
            var deflectionNonCutting = cantileverDeflectEndLoad(P.v,LFu,local_E,IF);    // Point load @ end of fluted section out of cut
            var deflectionCutting    = cantileverDeflectUniLoad(P.v,LFc,local_E,IF);    // Uniform load along fluted section in cut

            // NOTE: We ignore the contribution from the angle of deflection, which should be negligable for cutting purposes.
            DEFLECTION.v = trim_precision(deflectionShank + deflectionNonCutting + deflectionCutting);  // Total deflection
            
            // TESTING -- How much different is calculated deflection and max deflection?
            MXDEFLECTION.v = trim_precision(cantileverDeflectEndLoad((HP.v * OneHP) / SFM.v, L.v, local_E, Math.min(IF,IS)));    // Theoretical worst deflection if all force was pushing on the tip of the end mill
        }

        // ----------------------------------------
        // Maximum Deflection to permanently bend the end mill
        //
        // Yield is the STRESS at which the material deforms permanently
        // stress = F * L * Radius / I
        // F = (I * stress) / (r * l)
        //
        // TODO: Estimate Yield & Shear for fluted portion of end mill

        var yield_S = E.v * 1000;  // TODO: Total hack - values are close enough for HSS & Carbide, we can probably get away with it.
        BEND.v  = trim_precision(Math.min( (yield_S * IS) / ((SHANK.v/2) * LS),
                                           (yield_S * IF) / ((DIAMETER.v/2) * (LS + LFu)) ));
        P.limit = trim_precision(Math.min( BEND.v, P.limit));

        // ----------------------------------------
        // Maximum Torque to shear the end mill
        // http://www.engineeringtoolbox.com/torsion-shafts-d_947.html
        var shear_S = E.v * 1000;  // TODO: Total hack - values are close enough for HSS & Carbide, we can probably get away with it.
        var ISz = IS * 2;          // Polar moment of inertia of an area (along Z axis of end mill)
        var IFz = IF * 2;
        TWIST.v = trim_precision( Math.min( (shear_S * ISz) / (SHANK.v/2),
                                            (shear_S * IFz) / (DIAMETER.v/2) ));
        TORQUE.limit = trim_precision(Math.min( TWIST.v, TORQUE.limit));
        AvailableTorque.v = trim_precision(Math.min(AvailableTorque.v,TORQUE.limit));
        JUNKprint = false;
    }

    function new_compute()
    {
        setMemo("");

        // Load the inputs (convert units as we read them in)
        read_values(constants);
        read_values(parameters);

        // --------------------------------------------------------------------------------
        // Apply various logical constraints (highlight errors for user)

        constraint( [DOC,FL ]     , function () { return DOC.max <= FL.v },         "Max DOC " + DOC.max + " must be less than Flute Length " + FL.v);      // Can't cut deeper than flutes
        constraint( [WOC,DIAMETER], function () { return WOC.max <= DIAMETER.v },   "Max WOC " + WOC.max + " must be less than Flute Diameter " + DIAMETER.v);    // Can't cut wider than the endmill
        constraint( [L,FL ]       , function () { return FL.v    <= L.v },          "Flute Length " + FL.v + " must be less than Stickout " + L.v );     // Flutes can't be longer than stickout
        constraint( [PEAK_TQ_RPM,RPM],function(){ return PEAK_TQ_RPM.v <= RPM.max },"Peak Torque RPM " + PEAK_TQ_RPM.v + " must be less than Max RPM " + RPM.max);   // Peak RPM less than max RPM
        constraint( [WOC,CHIPLOAD], function()  { return CHIPLOAD.v <= WOC.min },   "Min WOC " + WOC.min + " must be larger than Chipload " + CHIPLOAD.v);      // Minimum cut width == Chipload 
        constraint( [DOC,CHIPLOAD], function()  { return CHIPLOAD.v <= DOC.min },   "Min DOC " + DOC.min + " must be larger than Chipload " + CHIPLOAD.v);      // Minimum cut depth == Chipload 
        constraint( [CORNER,DIAMETER],function(){ return Math.abs(CORNER.v) <= (DIAMETER.v/2) }, "Corner Radius " + CORNER.v + " must be less than End Mill Radius " + DIAMETER.v/2); // Corner Radius <= Radius
        constraint( [LEAD],         function()  { return LEAD.v >= 0 && LEAD.v <= 90 }, "Lead Angle must be 0 to 90 degrees");      // Lead angle must be valid
        constraint( [CORNER,LEAD],  function()  { return (CORNER.v != 0 && LEAD.v == 90) || (CORNER.v == 0 && LEAD.v <= 90) }, "Choose one: Lead Angle or Corner Radius"); // Either Lead OR Corner, not both

        // ---------------------------------------------------------------------
        if ( operation == "hsm" )
        {
            originalSFM      = SFM.max;
            originalCHIPLOAD = CHIPLOAD.max;

            SFM.max       *= HSM_SFM_MULTIPLIER;
            SFM.limit      = SFM.max;
            CHIPLOAD.max  *= HSM_CHIP_MULTIPLIER;
            CHIPLOAD.limit = CHIPLOAD.max;
        }

        // ---------------------------------------------------------------------
        // A bit hacky.. Lead/Tip/Corner-Radius interactions..
        var nonSquareDepth = 0;

        if ( CORNER.v != 0 )
        {
            uxDisable("in_LEAD");
            uxDisable("in_TIP");
            CORNER.min = -99999;
            LEAD.v = 90;
            TIP.v = Math.max( 0, DIAMETER.v - 2 * Math.abs(CORNER.v) );
            nonSquareDepth = Math.abs(CORNER.v);
        }
        else if ( LEAD.v < 90 )
        {
            uxDisable("in_CORNER");
            CORNER.v = 0;
            nonSquareDepth = ((DIAMETER.v-TIP.v)/2) * Math.tan(toRadians(LEAD.v));
            if (nonSquareDepth > FL.v)
            {
                nonSquareDepth = FL.v;
                TIP.v = DIAMETER.v - FL.v / Math.tan(toRadians(LEAD.v));
            }
        }
        else
        {
            uxEnable("in_LEAD");
            uxEnable("in_TIP");
            uxEnable("in_CORNER");
            TIP.v = DIAMETER.v;
        }

        // ---------------------------------------------------------------------
        // Draw the end mill profile
        //
        var profile = document.getElementById('profile');
        var ctx    = profile.getContext('2d');
        var size = 500;
        var scale = size / Math.max(DIAMETER.v, Math.max(SHANK.v, L.v));
        var center = size / 2;
        var profileWidth  = size;
        var profileHeight = size;

        profile.width  = profileWidth;
        profile.height = profileHeight;

        ctx.clearRect( 0, 0, profileWidth, profileHeight);
        ctx.setTransform(scale,0,0,scale,size/2,0);

        ctx.fillStyle="black";
        ctx.fillRect( -SHANK.v/2, 0, SHANK.v, L.v-FL.v);      // Rectangle for shank

        ctx.fillStyle="red";
        ctx.fillRect( -DIAMETER.v/2, L.v-FL.v, DIAMETER.v, FL.v - nonSquareDepth);    // Rectangle for flutes
        ctx.fillRect( -TIP.v/2, L.v-FL.v, TIP.v, FL.v);      // Rectangle for tip

        // ctx.fillStyle="magenta";
        if (CORNER.v > 0)
        {
            ctx.beginPath();
            ctx.arc(-(DIAMETER.v/2 - CORNER.v), L.v - CORNER.v, CORNER.v, 0, Math.PI);
            ctx.arc(  DIAMETER.v/2 - CORNER.v,  L.v - CORNER.v, CORNER.v, 0, Math.PI);
            ctx.fill();
        }
        else if (CORNER.v < 0)
        {
            ctx.fillRect( -DIAMETER.v/2, L.v-FL.v, DIAMETER.v, FL.v);
            // tzRect( ctx, scale, center,-DIAMETER.v/2, L.v-FL.v, DIAMETER.v, FL.v);

            ctx.fillStyle="white";
            ctx.beginPath();
            ctx.arc(-DIAMETER.v/2, L.v, -CORNER.v, Math.PI, 2*Math.PI);
            ctx.arc( DIAMETER.v/2, L.v, -CORNER.v, Math.PI, 2*Math.PI);
            ctx.fill();
        }
        else if (LEAD.v < 90)
        {
            ctx.beginPath();
            ctx.moveTo(-DIAMETER.v/2,   L.v - nonSquareDepth);
            ctx.lineTo(-TIP.v/2,        L.v);
            ctx.lineTo( TIP.v/2,        L.v);
            ctx.lineTo( DIAMETER.v/2,   L.v - nonSquareDepth);
            ctx.closePath();
            ctx.fill();
        }
       ctx.setTransform(1,0,0,1,0,0);


        // ---------------------------------------------------------------------
        // Pre-compute overlapping area of endmill with workpiece given WOC & DOC.
        //

        // Get the CanvasPixelArray from the given coordinates and dimensions.
        var imgd = ctx.getImageData(0, 0, profileWidth, profileHeight);
        pix = imgd.data;

        var pixelArea = 1 / (scale * scale);
        var highestX  = 0;

        for ( var y = size-1; y >= 0; y-- )
        {
            var lastArea = 0;
            for ( var x = size-1; x >= 0; x-- )
            {
                var offset = 4* (y * size + x);
                if ( pix[offset  ] >  0 &&   // Is this pixel red?
                     pix[offset+1] == 0 &&
                     pix[offset+2] == 0 &&
                     pix[offset+3] >  0 )
                {
                    lastArea += pixelArea;
                    highestX = Math.max( x, highestX );     // Record the widest point that we found a red pixel
                }

                // Set the MRR for this DOC/WOC combo
                area[x][y] = lastArea + area[x][y+1];

                // // Visualize MRR
                // pix[offset  ] = (lastArea + area[x][y+1]) * (size*size)/255;
                // pix[offset+1] = 0;
                // pix[offset+2] = 0;
                // pix[offset+3] = (area[x][y] == area[x+1][y]) ? 128 : 255;
            }

            // Assign the max diameter of the tool overlapping the workpiece as the effective diameter.
            effDiameter[y] = 2 * ((highestX+1) - (size/2))/scale;
        }

        // Draw the overlapping area
        ctx.putImageData(imgd, 0, 0);


        // ---------------------------------------------------------------------
        // Run the optimizer a few times, looking for some valid feeds & speeds
        //
        for (var z = 0; z < 100; z++)
        {
            optimize();

            // If the resulting parameter space is valid, then record it.
            if ( validate(parameters) )
                results.push( { MRR: MRR.v,
                                SFM: SFM.v,
                                WOC: WOC.v,
                                DOC: DOC.v,
                                RPM: RPM.v,
                                IPM: IPM.v,
                                HP:   HP.v,
                                CHIPLOAD: CHIPLOAD.v,
                                DEFLECTION: DEFLECTION.v } );
        }

        if ( results.length > 1 )
        {
            // -----------------------------------------------------------------        
            // Pick a parameter set to display as the "result" - here we pick the one with maximum MRR
            //
            results.sort(function (a,b) {return b.MRR - a.MRR;});   // Sort by MRR, descending
//            results.sort(function (a,b) {return (b.MRR == a.MRR) ? b.DOC - a.DOC : b.MRR - a.MRR;});   // Sort by MRR, descending, then DOC descending
            results = results.splice(0,MAX_RESULTS);                // Only keep the best values.

            // Load this set of parameters and recalculate results
            SFM.v       = results[0].SFM;
            CHIPLOAD.v  = results[0].CHIPLOAD;
            WOC.v       = results[0].WOC;
            DOC.v       = results[0].DOC;

            JUNKprint = true;
            finalize();


            // // --------------------------------------------
            // // TESTING tangential force prediction model  (these are constants for Aluminum)
            // var psi = 54625;
            // var TiC = teethInCut( DIAMETER.v, WOC.v, TEETH.v );
            // var Ft = tangentialForceLbs( psi, DOC.v * CHIPLOAD.v, TiC, 1.1, 1.1 );
            // var Tq = tangentialToTorque(Ft, DIAMETER.v);
            // var Hp = tangentialToHp(Ft, SFM.v);
            // setMemo("Ft: " + trim_precision(Ft) + "  Tq: " + trim_precision(Tq) + "  Hp: " + trim_precision(Hp) );

            // --------------------------------------------
            //  Draw the representation of the material in the cut.
            var canvas = document.getElementById('profile');
            var ctx    = canvas.getContext('2d');

            // Get the CanvasPixelArray from the given coordinates and dimensions.
            var imgd2 = ctx.getImageData(0, 0, size, size);
            var pix2 = imgd2.data;

            var lowX = 0;
            var lowY = 0;
            var hiX = 0;
            var hiY = 0;

            // Select appropriate integration limits
            if ( operation == "slot" )
            {
                lowX = -DIAMETER.v/2;
                hiX  =  DIAMETER.v/2;
            }
            else
            {
                lowX = DIAMETER.v/2 - WOC.v;
                hiX  = DIAMETER.v/2;
            }
            lowY = L.v - DOC.v;
            hiY  = L.v;

            lowX = Math.floor( lowX * scale);
            hiX  = Math.floor( hiX  * scale);

            lowX += size/2;
            hiX  += size/2;
            lowX *= 4;
            hiX  *= 4;

            lowY = Math.floor( lowY * scale );
            hiY  = Math.floor( hiY  * scale )
            lowY *= size*4;
            hiY  *= size*4;

            // Set the overlapping pixels to be BLUE
            for (var x = lowX; x < hiX; x += 4)
            {
                for (var y = lowY; y < hiY; y += 4*size)
                {
                    if ( pix[x+y  ] >  0 &&   // Is this pixel red?
                         pix[x+y+1] == 0 &&   
                         pix[x+y+2] == 0 &&   
                         pix[x+y+3] >  0 )
                    {
                        pix2[x+y  ] = 0;
                        pix2[x+y+1] = 0;
                        pix2[x+y+2] = 255;  // Blue
                        pix2[x+y+3] = 255;  // Opaque
                    }
                }
            }

            // Draw the overlapping area
            ctx.putImageData(imgd2, 0, 0);


            // ---------------------------------------------------------------------
            // Draw the radial engagement
            //
//             var radial = document.getElementById('radial');
//             var ctx2    = radial.getContext('2d');
//             var size2 = 500;
//             var diameter = EffectiveDiameter.v;
//             var radius = diameter/2;
//             var scale2 = size2 / diameter;
// //            var scale2 = size2 / Math.max(WOC.v, DIAMETER.v/2);
//             radial.width  = size2;
//             radial.height = size2;

//             ctx2.clearRect( 0, 0, radial.width, radial.height);
//             ctx2.setTransform(scale2,0,0,scale2,size2 - (scale2 * radius),0);

//             // Uncut material
//             ctx2.fillStyle="gray";
//             ctx2.fillRect(radius - WOC.v, 0, WOC.v, radius);

//             // Cutter's current position
//             ctx2.fillStyle="red";
//             ctx2.beginPath();
//             ctx2.arc(0, radius, radius, 0, 2*Math.PI);
//             ctx2.fill();

//             // Radial Engagement while Profiling
//             ctx2.fillStyle="white";
//             ctx2.fillRect(-radius, 0, diameter - WOC.v, diameter);

//             // Cutter's previous position
//             ctx2.beginPath();
//             ctx2.arc(0, (radius + AdjustedIPT.v), radius, 0, 2*Math.PI);
//             ctx2.fill();

//             // Stroke current position
//             ctx2.beginPath();
//             ctx2.strokeStyle="black";
//             ctx2.lineWidth=0.5/scale2;
//             ctx2.arc(0, radius, radius, 0, 2*Math.PI);
//             ctx2.stroke();


            // --------------------------------------------
            //  Graphs
            // if ( typeof google != "undefined" &&
            //      typeof google.visualization != "undefined" )
            // {
            //     // DOC/WOC axis, with MRR heat map, IPM-sized bubbles, labeled with RPM
            //     var graph = [];
            //     graph[0] = ['RPM', 'WOC', 'DOC', 'MRR', 'IPM'];
            //     for ( var i = 0; i < results.length; i++ )
            //         graph[graph.length] = [ ' ' + imperialToDisplay(results[i].RPM, RPM.metToImp)
            //                               , imperialToDisplay(results[i].WOC, WOC.metToImp)
            //                               , imperialToDisplay(results[i].DOC, DOC.metToImp)
            //                               , imperialToDisplay(results[i].MRR, MRR.metToImp)
            //                               , imperialToDisplay(results[i].IPM, IPM.metToImp) ];
            //     drawChart(graph, 'chart_div', docOptions);

            //     // RPM/IPM axis, with MRR heat map, and HP-sized bubbles
            //     graph = [];
            //     graph[0] = ['DOC','IPM', 'RPM', 'MRR', 'HP'];
            //     for ( var i = 0; i < results.length; i++ )
            //         graph[graph.length] = [ ' ' + imperialToDisplay(results[i].DOC, DOC.metToImp)
            //                               , imperialToDisplay(results[i].IPM, IPM.metToImp)
            //                               , imperialToDisplay(results[i].RPM, RPM.metToImp)
            //                               , imperialToDisplay(results[i].MRR, MRR.metToImp)
            //                               , imperialToDisplay(results[i].HP,  HP.metToImp) ];
            //     drawChart(graph, 'chart_div2', rpmOptions);
            // }
            // else
            // {
            //     // If Google Graphs are not available, display alternatives in text..
            //     var alt = document.getElementById('ALTERNATIVES');
            //     alt.innerHTML = '<table><tr><td>RPM</td><td>IPM</td><td>WOC</td><td>DOC</td><td>MRR</td></tr>';
            //     for ( var i = 0; i < results.length; i++ )
            //         alt.innerHTML += '<tr><td>'
            //                          + imperialToDisplay(results[i].RPM, RPM.metToImp) + '</td><td>'
            //                          + imperialToDisplay(results[i].IPM, IPM.metToImp) + '</td><td>'
            //                          + imperialToDisplay(results[i].WOC, WOC.metToImp) + '</td><td>'
            //                          + imperialToDisplay(results[i].DOC, DOC.metToImp) + '</td><td>'
            //                          + imperialToDisplay(results[i].MRR, MRR.metToImp) + '</td></tr>';
            //     alt.innerHTML += '</table>'
            // }
        }

        // --------------------------------
        // Generate a URL with the inputs from the form so users can bookmark the parameters.
        //
        var inputs = document.getElementsByTagName('input');
        var params = "?";
        for (var index = 0; index < inputs.length; ++index)
        {
            var v = inputs[index];
            if ( v.id != "" )
            {
                if ( v.type == "checkbox" )
                    params += v.id + '=' + v.checked + '&'; 
                // else if ( v.type == "radio" )
                //     params += v.id + '=' + getRadioValue(v.id) + '&';
                else
                    params += v.id + '=' + encodeURIComponent(v.value) + '&';
            }
        }

        var selects = document.getElementsByTagName('select');
        for (var index = 0; index < selects.length; ++index)
        {
            var sel = selects[index];
            params += sel.id + '=' + sel.value + '&';
        }

        var cut = document.getElementById('CURRENT');
        cut.href = (window.location.href.split('?')[0]) + params;

        // -----------------------------------------------------------------        
        // Display results - highlight if the results are invalid
        //
        displayAll();
        document.getElementById('OUT').style.backgroundColor = validate(parameters) ? "" : "pink";
    }

    // -----------------------------------------------------------------
    // Allocate an input parameter that remains constant
    function constant(name,decimals,min,max,metToImp)
    {
        var p     = {};
        p.name    = name;

        p.max     = 0;//getValue('in_'+name, metToImp);
        p.limit   = 0;
        p.min     = p.max;
        p.v       = p.max;

        p.decimals= 5;
        p.metToImp= metToImp; // Metric to Imperial conversion
        constants[name] = p;

        setupValue('in_'+name, min, max );  // this should go in a page-load function, not here
        return p;
    }
    
    // Allocate an input parameter with MIN/MAX range
    function parameter(name,decimals,min,max,metToImp)
    {
        var p       = {};
        p.name      = name;
//
        p.min       = 0;//getValue('min_'+name, metToImp);
        p.max       = 0;//getValue('max_'+name, metToImp);
        p.limit     = 0;
        p.v         = p.max;
        
        p.decimals  = 5; //decimals;
        p.metToImp  = metToImp; // Metric to Imperial conversion
        parameters[name] = p;

        // Setup HTML with event handlers, min/max/step, etc..  (TODO: this should go in a page-load function)
        setupValue('min_'+name, min, max );
        setupValue('max_'+name, min, max );
        return p;
    }

    function setMemo(m)
    {
        var v = document.getElementById("MEMO");
        if ( v == null ) return;
        var i = v.innerHTML;
        var n = (m == "" ? "" : i + "<br/>") + m;
        v.innerHTML = n;
//        console.info(n);
    }

    // Add constraints to be checked during optimization
    function constraint(vs,e,m)
    {
        if ( e() == false )
        {
            setMemo(m);
            for (var i = 0; i < vs.length; i++)
            {
//                console.info(vs[i].name);
                highlightInputs(vs[i].name,"pink");
            }
        }
    }

    function displayAll()
    {
        // Update the display
        display(parameters);
        display(constants);
    }

    // -----------------------------------------------------------------
    // Utility functions
    function rng()
    {
        ridx = (ridx + 1) % RandomNumbers.length;
        return RandomNumbers[ridx];
    }

    function avg( minC, maxC )
    {
        var delta = maxC - minC;
        return minC + (rng() * delta);
    }

    // Is this parameter valid?
    function validP(p)
    {
        var ret = p.v   <= p.limit &&
                  p.v   >= p.min;
        // if (!ret)
        // {
        //     setMemo("ERROR: "+p.name+" not within limits.");
        //     console.info("invalid parameter", p.name);
        // }
        return ret;
    }
    
    function highlight(name,color)
    {
        var v = document.getElementById(name);
        if ( v != null && color != "" )
            v.style.backgroundColor = color;
    }

    function highlightInputs(name,color)
    {
        highlight('min_'+name,color);
        highlight('max_'+name,color);
        highlight('in_'+name,color);
    }

    function toImperial(val,scale)
    {
        if ( useMetric ) val *= scale;
        return Number(val.toPrecision(4));
    }

    function imperialToDisplay(val,scale)
    {
        if ( useMetric ) val /= scale;
        return Number(val.toPrecision(4));
    }

    // Get a parameter value from the input form, validate & highlight errors
    function getValue(name,scale)
    {
        var v = document.getElementById(name);
        if ( v == null )  return null;

        if ( v.type == "checkbox" )
            return v.checked;
        // else if ( v.type == "radio" )
        //     return v.value;

        // Evaluate the field (allow inputs like "3/8")
        var val = eval(v.value);

        // console.info(name,"=", v.value, "=>", val);
        if ( !isNumeric(val) )
            highlight( name, "yellow");   // Highlight non-number inputs
        return toImperial(val,scale);
    }

    function convert_value(name,scale)
    {
        var v = document.getElementById(name);
        if ( v == null )  return;
        if ( v.type == "checkbox" ) return;
        // if ( v.type == "radio" ) return;

        // Evaluate the field (allow inputs like "3/8")
        var val = eval(v.value);
        if (!isNumeric(val)) return;
        val *= scale;
        v.value = Number(val.toPrecision(4));               // Convert values in place
    }

    function convert_inputs(vs,toMetric)
    {
        Object.keys(vs).forEach(function(n) {
            var p = vs[n];
            var scale = !toMetric ? (1 / p.metToImp) : p.metToImp;
            convert_value('in_'+p.name,scale);
            convert_value('min_'+p.name,scale);
            convert_value('max_'+p.name,scale);
        });
    }

    function clear_highlight(name)
    {
        var v = document.getElementById(name);
        if ( v == null ) return;
        v.style.backgroundColor = "";
    }

    function reset_highlights(vs)
    {
        Object.keys(vs).forEach(function(n) {
            clear_highlight('min_'+n);
            clear_highlight( 'in_'+n);
            clear_highlight('max_'+n);
        });
    }

    function read_values(vs)
    {
        Object.keys(vs).forEach(function(n) {
            var p = vs[n];

            var a = getValue('min_'+n, p.metToImp);
            var b = getValue('in_' +n, p.metToImp);
            var c = getValue('max_'+n, p.metToImp);

            if ( a != null ) p.min = a;
            if ( a == null && b == null ) p.min = 0;
            if ( a == null && b != null ) p.min = b;

            if ( c != null ) p.max = c;
            if ( c == null && b == null ) p.max = 99999999;
            if ( c == null && b != null ) p.max = b;

            if ( b != null ) p.v = b;
            if ( b == null ) p.v = p.max;

            if ( p.min > p.max ) { highlightInputs(n,"pink"); setMemo("Error: " + n + " range error (check min/max)"); }
            p.min   = Math.min( p.min, p.max );   // Force min <= max, so we can continue even if they typed in the wrong values.
            p.limit = p.max;
        });
    }

    // Setup HTML events, min/max/step, etc.
    function setupValue(n,min,max,step)
    {
        var v = document.getElementById(n);
        if ( v == null )  return;
        if ( v.type == "checkbox" )  return;
        // if ( v.type == "radio" ) return;

        v.setAttribute("onchange", "inputChanged('"+n+"')" ); // Pass the ID into the change function
    }

    // Initialize the variables to random values near the middle of their ranges
    function initialize(vs)
    {
        Object.keys(vs).forEach(function(n) {
            var p   = vs[n];
            p.v     = Number(avg( p.min, p.max ).toPrecision(4));
            p.limit = p.max;
        });
    }

    function reset_limits(vs)
    {
        Object.keys(vs).forEach(function(n) {
            var p   = vs[n];
            p.limit = p.max;
        });
    }

    // Check that the result values are within their MIN/MAX range
    function validate(vs)
    {
        var valid = true;
        Object.keys(vs).forEach(function(n) {
            var p = vs[n];
            valid = valid && validP( p );
        });
        return valid;
    }

    function error_distance(vs)
    {
        var d = 0;
        Object.keys(vs).forEach(function(n) {
            var p = vs[n];
            if ( p.v > p.limit ) d += p.v - p.limit;
            if ( p.v < p.min   ) d += p.min - p.v;
        });
        return d;
    }

    function convertAll()
    {
        // TODO: Swap units on graphic display.
        useMetric    = document.getElementById('in_METRIC').checked; // Hack!

        // State of the checkbox just changed, so we use the opposite state here.
        convert_inputs(constants,!useMetric);
        convert_inputs(parameters,!useMetric);
        inputChanged(null);
    }

    // Update the display with the values of the variables
    function display(vs)
    {
        Object.keys(vs).forEach(function(n) {
            var p = vs[n];
            var item = document.getElementById(p.name);

//            if (!isNumeric(p.min) || !isNumeric(p.v) || !isNumeric(p.max))
//                console.info(p.name, p.min, p.v, p.max);
            
            if ( item != null )
            {
                // TODO: Some percentages better expressed as percent of another parameter (ie: WOC as percent of DIAMETER)..
                var mx  = p.limit;
                var v   = p.v;
                var pct = Number((100*v/mx).toPrecision(2));
                item.innerHTML = imperialToDisplay( p.v, p.metToImp ) + ((pct < 1) ? "" : (" <small>(" + pct + "%)</small>"));

                // Highlight values near their limits..
                var close_to_limit = Math.abs(v - mx) <  (mx * 0.05);
                var beyond_limit = v < p.min ||
                                   v > mx    ||
                                   !isNumeric(v);

                if ( beyond_limit )         item.style.backgroundColor = "red";
                else if ( close_to_limit )  item.style.backgroundColor = "orange";
                else item.style.backgroundColor = "white";
            }
//            else
//                console.info( 'Missing: ', vs[i].name );
        });
    }

    function uxDisable(name)
    {
        var v = document.getElementById(name);
        if ( v == null ) return;
        v.style.backgroundColor = "LightGray";
        v.disabled = true;
    }

    function uxEnable(name)
    {
        var v = document.getElementById(name);
        if ( v == null ) return;
        v.style.backgroundColor = "";
        v.disabled = false;
    }

    function uxPick(name)
    {
        inputChanged();
    }

    function reset_compute()
    {
        ridx       = 0;  // Reset random numbers
        tryCounter = 0;
        results    = [];
        //drawChart([['RPM', 'WOC', 'DOC', 'MRR', 'IPM'],['0',0,0,0,0]], 'chart_div', docOptions);
        //drawChart([[' ','IPM', 'RPM', 'MRR', 'HP'],['',0,0,0,0]], 'chart_div2', rpmOptions);
        // document.getElementById('ALTERNATIVES').innerHTML = "";
    }

    function inputChanged(v)
    {
        useMetric  = document.getElementById('in_METRIC').checked;
        document.getElementById('inputs').className = useMetric ? "container metric" : "container imperial";

        var eOpr = document.getElementById("ux_OPR");
        operation= eOpr.options[eOpr.selectedIndex].value;

        var eTool = document.getElementById("ux_E");
        var vTool = eTool.options[eTool.selectedIndex].value;

        var eMat = document.getElementById("ux_UNITPOWER");
        var vMat = eMat.options[eMat.selectedIndex].value;

        reset_highlights(parameters);
        reset_highlights(constants);

        // Some fields are locked when using the pulldowns..
        uxEnable("in_UNITPOWER");
        uxEnable("in_E");
        uxEnable("max_SFM");
        uxEnable("max_CHIPLOAD");

        if ( vTool != "CUSTOM" )
        {
            uxDisable("in_E");     document.getElementById('in_E').value     = Modulus[vTool];
            // uxDisable("in_YIELD"); document.getElementById('in_YIELD').value = Yield[vTool];
            // uxDisable("in_SHEAR"); document.getElementById('in_SHEAR').value = Shear[vTool];
        }
        if ( vMat  != "CUSTOM" ) { uxDisable("in_UNITPOWER"); document.getElementById('in_UNITPOWER').value = unitPower[vMat]; }
//*
        if ( vTool != "CUSTOM" && vMat != "CUSTOM" )
        {
            // Load SFM & Chipload from the table.
            document.getElementById('max_SFM').value = imperialToDisplay( cutParameters[vTool][vMat][0], SFM.metToImp );
            document.getElementById('max_CHIPLOAD').value = roundTo( eval(document.getElementById('in_DIAMETER').value) / cutParameters[vTool][vMat][1], 4);
            uxDisable("max_SFM");
            uxDisable("max_CHIPLOAD");
        }
//*/
        reset_compute();
        new_compute();
    }


    // -----------------------------------------------------------------------------------------
    // NelderâMead "Simplex" Method
    // https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method
    // Adapted from: http://csg.sph.umich.edu//abecasis/class/815.20.pdf

    function make_simplex(dimension,points)
    {
        var simplex = [];

        for ( var i=0; i < dimension+1; i++)
        {
            simplex.push([]);
            for (var j = 0; j < dimension; j++)
                simplex[i].push( points[j] );
        }

        simplex[0][0] += (SFM.max - SFM.min)/100;
        simplex[1][1] += (CHIPLOAD.max - CHIPLOAD.min)/100;
        simplex[2][2] += (WOC.max - WOC.min)/100;
        simplex[3][3] += (DOC.max - DOC.min)/100;

//        for (var j = 0; j < dimension; j++)
//            simplex[j][j] += 0.001;

        return simplex;
    }

    function evaluate_simplex(dimension,simplex,fx,func)
    {
        for ( var i=0; i < dimension+1; i++)
            fx[i] = func(dimension, simplex[i]);
    }

    function simplex_extremes(dimension,fx,extremes)
    {
        if ( fx[0] > fx[1])
        {
            extremes.hi = 0;    // "Highest"
            extremes.lo = 1;    // "Lowest"
            extremes.nhi = 1;   // "Next-Highest"  (second-higest value)
        }
        else
        {
            extremes.hi = 1;
            extremes.lo = 0;
            extremes.nhi = 0;
        }

        for ( var i = 2; i < dimension+1; i++)
        {
            if (fx[i] <= fx[extremes.lo])
                extremes.lo = i;
            else if (fx[i] > fx[extremes.hi])
            {
                extremes.nhi = extremes.hi;
                extremes.hi = i;
            }
            else if (fx[i] > fx[extremes.nhi])
                extremes.nhi = i;
        }

        // console.info(" ==> ",fx[extremes.lo]);
    }

    function simplex_bearings(dimension,simplex,midpoint,line,hi)
    {
        for (var j = 0; j < dimension; j++)
            midpoint[j] = 0;

        for (var i = 0; i < dimension+1; i++)
            if (i != hi)
                for (var j=0; j<dimension; j++)
                    midpoint[j] += simplex[i][j];

        for (var j = 0; j < dimension; j++)
        {
            midpoint[j] /= dimension;
            line[j] = simplex[hi][j] - midpoint[j];
        }
    }

    function update_simplex(dimension,simplex,fx,idx,midpoint,line,scale,func)
    {
        var update = 0;
        var next = [];
        for (var i=0; i< dimension; i++)
            next.push(midpoint[i] + scale * line[i]);
        new_fx = func(dimension,next);

        if (new_fx < fx[idx])  // GOAL: Minimize fx
        {
//            console.info(next[0],next[1],next[2],next[3]," ==> ",new_fx);

            for (var i = 0; i < dimension; i++)
                simplex[idx][i] = next[i];
            fx[idx] = new_fx;
            update = 1;
        }

        return update;
    }

    function contract_simplex(dimension,simplex,fx,lo,func)
    {
        for (var i=0; i<dimension+1; i++)
            if (i != lo)
            {
                for (var j=0; j<dimension; j++)
                    simplex[i][j] = (simplex[lo][j]+simplex[i][j])/2;
                fx[i] = func(dimension,simplex[i]);
            }
    }

    var ZEPS = 0.000001;    // Good enough.
    function check_tolerance(fmax, fmin, tolerance)
    {
        var delta = Math.abs(fmax - fmin);
        var accuracy = (Math.abs(fmax) + Math.abs(fmin)) * tolerance;
        return (delta < (accuracy + ZEPS));
    }

    function amoeba(dimension,point,func,tolerance)
    {
        var extremes = {};
        var fx = [];
        var midpoint = [];
        var line = [];
        var simplex = make_simplex(dimension,point);

        evaluate_simplex(dimension,simplex,fx,func);

        var count = 100;
        while (count > 0)
        {
            count -= 1;
            simplex_extremes(dimension,fx,extremes);
            simplex_bearings(dimension,simplex,midpoint,line,extremes.hi);

            if ( check_tolerance(fx[extremes.hi], fx[extremes.lo], tolerance))
            {
                // console.info("    *** Minimum Found! ***");
                break;
            }

            update_simplex(dimension, simplex, fx, extremes.hi, midpoint, line, -1, func );

            if (fx[extremes.hi] < fx[extremes.lo])
            {
                // console.info("    Doubling");
                update_simplex(dimension, simplex, fx, extremes.hi, midpoint, line, -2, func );
            }
            else if (fx[extremes.hi] >= fx[extremes.nhi])
            {
                if ( update_simplex(dimension, simplex, fx, extremes.hi, midpoint, line, 0.5, func ) == 0)
                {
                    // console.info("    Contracting");
                    contract_simplex(dimension, simplex, fx, extremes.lo, func);
                }
                else
                {
                    // console.info("    Halving");
                }
            }
        }

        // console.info(" ==> ",fx[extremes.lo], "   FINAL");

        for(var j=0; j < dimension; j++)
            point[j] = simplex[extremes.lo][j];

        return fx[extremes.lo];
    }

    function optFunc(dimension,point)
    {
        // Load the point
        SFM.v      = point[0];
        CHIPLOAD.v = point[1];
        WOC.v      = point[2];
        DOC.v      = point[3];

        // Recompute the parameters
        finalize();

        if (validate(parameters))
            return 0 - MRR.v; // For valid parameters, minimize -MRR
        else
            return error_distance(parameters);  // Distance to valid parameter space.. naturally minimizes toward valid parameters.
    }

    function optimize()
    {
        var count = 10;      // TESTING
        var point = [];
        
        // Find a valid initial point...
        do {
            initialize(parameters);
            point[0] = SFM.v;
            point[1] = CHIPLOAD.v;
            point[2] = WOC.v;
            point[3] = DOC.v;
            finalize();
            count -= 1;
        } while (!validate(parameters) && count > 0);

        // console.info("----- NEW SIMPLEX -----")
        // console.info(point[0],point[1],point[2],point[3]);

        amoeba(4,point,optFunc,0.00001);

        // Load the final value
        SFM.v      = point[0];
        CHIPLOAD.v = point[1];
        WOC.v      = point[2];
        DOC.v      = point[3];
        finalize();

        // console.info(SFM.v,CHIPLOAD.v,WOC.v,DOC.v);
    }

    // -----------------------------------------------------------------------------------------
    // Searching settings

    // Turn a search string into a regular expression for matching
    // "foo" -> "/.*f.*o.*o.*/i"
    function str2Search(s)
    {
        var res = ".*";
        var ss = s.split("");
        for (var i=0; i < ss.length; i++)
            res = res + ss[i] + ".*";
        return res;
    }

    function searchArray(s,a)
    {
        var res = [];
        var regex = new RegExp(s, "i");
        for (var i=0; i < a.length; i++)
            if (a[i].match(s))
                res.push(a[i]);
        return res;
    }

    function updateSearch()
    {
        var search  = document.getElementById('search').value;
        var reg = str2Search(search);

        var v = document.getElementById("saved");
        if ( v == null ) return;
        var s = "";
        v.innerHTML = "No match found.";

        var count = 0;
        var regex = new RegExp(reg, "i");
        Object.keys(localStorage).forEach(function(n) {
            if (regex.test(n))
            {
                if (s == "")
                    s = n;
                else
                    s = s + "<br/>" + n;
                v.innerHTML = s;
                count++;
            }
        });

        // Enable / Disable the Load/Delete buttons
        var l = document.getElementById('load');
        if ( l == null ) return;
        l.disabled = (count != 1);

        var l = document.getElementById('delete');
        if ( l == null ) return;
        l.disabled = (count != 1);
    }

    function generateParameters(inputs)
    {
        var params = "";
        for (var index = 0; index < inputs.length; ++index)
        {
            var v = document.getElementById(inputs[index]);
            if ( v != null )
            {
                if ( v.type == "checkbox" )
                    params += v.id + '=' + v.checked + '&'; 
                else
                    params += v.id + '=' + encodeURIComponent(v.value) + '&';
            }
        }
        return params;
    }

    function saveMachine()
    {
        var inputs = ["in_METRIC","max_RPM","min_RPM","in_PEAK_TORQUE_RPM","max_IPM","min_IPM","max_HP","machine"];
        var v = document.getElementById("machine");
        saveSettings("MACHINE: " + v.value, generateParameters(inputs));
    }

    function saveTool()
    {
        var inputs = ["in_METRIC","ux_E","in_TEETH","in_SHANK","in_DIAMETER","in_TIP","in_L","in_FL","in_CORNER","in_LEAD","in_HELIX","tool"];
        var v = document.getElementById("tool");
        saveSettings("TOOL: " + v.value, generateParameters(inputs));
    }

    function saveCut()
    {
        var inputs = ["in_METRIC","ux_OPR","ux_UNITPOWER","in_UNITPOWER","max_DOC","min_DOC","max_WOC","min_WOC","max_SFM","min_SFM",
                      "max_CHIPLOAD","min_CHIPLOAD","max_DEFLECTION","max_TORQUE","max_P","max_PAxial","in_HELICAL","cut"];
        var v = document.getElementById("cut");
        saveSettings("CUT: " + v.value, generateParameters(inputs));
    }

    // ----------------------------------------------------------------------------------------
    // HTML5 Storage
    // http://diveintohtml5.info/storage.html
    //
    function supports_html5_storage() {
      try {
        return 'localStorage' in window && window['localStorage'] !== null;
      } catch (e) {
        return false;
      }
    }

    /*
    var foo = localStorage.getItem("bar");
    localStorage.setItem("bar", foo);

    var foo = localStorage["bar"];
    localStorage["bar"] = foo;
      localStorage.removeItem(in DOMString key);
      localStorage.clear();
      localStoragelength;
      localStorage.key(in unsigned long index);
    */

    var VERSION = 1.0;
    function saveSettings(name,params)
    {
        if (!supports_html5_storage()) { setMemo("FAILED: Local storage not supported!"); return false; }
        localStorage[name] = "VERSION="+VERSION+"&"+params; //JSON.stringify( [VERSION, params] );
        updateSearch();
        return true;
    }

    function decodeParameters(query)
    {
        // --------------------------------
        // Decode the URL parameters - fill in the text boxes on the page for any parameter sent in the query string.
        //
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++)
        {
            var pair = vars[i].split("=");
            if ( pair[0] != null && pair[0] != "")
            {
                var v = document.getElementById( pair[0] );
                if ( v != null )
                {
                    if ( v.type == "checkbox" )
                        v.checked = pair[1] == 'true';
                    // else if ( v.type == "radio" )
                    //     setRadioValue(pair[0],pair[1]);
                    else
                        v.value = decodeURIComponent(pair[1]);
                }
            }
        }
    }

    function loadSettingByName(name) {
        if (!supports_html5_storage()) { setMemo("FAILED: Local storage not supported!"); return false; }

        var cut = localStorage[name];
        if (!cut) { setMemo("FAILED: Setting \"" + name + "\" not found!"); return false; }
//        if ( cut[0] != VERSION ) { localStorage.clear(); return false; }

        // Read and apply the settings from the PARAM string..
        decodeParameters(cut);
        return true;
    }

    function loadSearch()
    {
        var v = document.getElementById("saved");
        if ( v == null ) return;
        loadSettingByName(v.innerHTML);
    }

    function deleteSearch()
    {
        var v = document.getElementById("saved");
        if ( v == null ) return;
        localStorage.removeItem(v.innerHTML);
        updateSearch();
    }

    // -----------------------------------------------------------------------------------------
    // Code imported from other sources

    // http://www.jacklmoore.com/notes/rounding-in-javascript/
    function roundTo(value, decimals) {
        if (value <= 0.000001) return 0;
        return Number(Math.round(Number(value)+'e'+decimals)+'e-'+decimals);
    }

    // http://stackoverflow.com/questions/18082/validate-decimal-numbers-in-javascript-isnumeric
    function isNumeric(n) {
      return !isNaN(parseFloat(n)) && isFinite(n);
    }

    // Somewhere on StackOverflow...
    function toDegrees (angle) {
      return angle * (180 / Math.PI);
    }

    function toRadians (angle) {
      return angle * (Math.PI / 180);
    }

    // http://stackoverflow.com/questions/9618504/get-radio-button-value-with-javascript
    function getRadioValue(name)
    {
        var radios = document.getElementsByName(name);

        for (var i = 0, length = radios.length; i < length; i++) {
            if (radios[i].checked)
                return radios[i].value;
        }
    }

    function setRadioValue(name,val)
    {
        var radios = document.getElementsByName(name);

        for (var i = 0, length = radios.length; i < length; i++) {
            if (radios[i].value == val)
                radios[i].checked = true;
            else
                radios[i].checked = false;
        }
    }

    // http://www.kennametal.com/en/resources/engineering-calculators/end-milling-calculators/force-torque-and-power.html
    // http://www.kennametal.com/en/resources/engineering-calculators/end-milling-calculators/km-solid-end-mill-torque-and-horsepower.html

    function calculateHB(RockwellValue, type) {
        if (type == "hrb") { //value is one HRC
            if ((RockwellValue < 40))
                var value = 0.0;
            else if ((RockwellValue < 55))
                var value = (0.806 * RockwellValue) + 48;
            else if ((RockwellValue < 70))
                var value = (1.646 * RockwellValue) + 9;
            else if ((RockwellValue < 85))
                var value = (2.625 * RockwellValue) - 60;
            else if ((RockwellValue < 96))
                var value = (4.555 * RockwellValue) - 224;
            else if ((RockwellValue < 121))
                var value = (6.9 * RockwellValue) - 447;

        } else {
            if ((RockwellValue < 20))
                var value = 0.0;
            else if ((RockwellValue < 31))
                var value = (5.791 * RockwellValue) + 109.5;
            else if ((RockwellValue < 41))
                var value = (8.57 * RockwellValue) + 28;
            else if ((RockwellValue < 51))
                var value = (11.158 * RockwellValue) - 80;
            else if ((RockwellValue < 61))
                var value = (17.57 * RockwellValue) - 404;
            else if ((RockwellValue < 66))
                var value = (17.2 * RockwellValue) - 379;
        }

        return roundNumber(value, 0);
    }

    // Kennametal
    

    function maxloadjoint(radius, totalStickout, coeffload) { return coeffload / Math.sqrt(Math.pow(radius, 2) + Math.pow(0.8 * totalStickout, 2)); }
    function maxtangential(maxloadjoint)                    { return 0.75 * maxloadjoint; }
    function torquejoint(loadjoint, coefftorque)            { return loadjoint * coefftorque / 12; }
    function maxtorque(maxtangential, coefftorque)          { return maxtangential * coefftorque / 12; }
    function EMTorque(tangentialForce, radius)              { return tangentialForce * radius / 12; }

    function calculateCFTorque(hP, rpm)                     { return (((63.025 * hP) / rpm) * (1.0 / 12.0)) * 1000; }


    function calculateKMcoeffload(DKMInputKMSize) {
        if (a == 32) {
            var b = 2240
        }
        if (a == 40) {
            var b = 4530
        }
        if (a == 50) {
            var b = 10460
        }
        if (a == 63) {
            var b = 20300
        }
        if (a == 80) {
            var b = 36400
        }
        if (a == 100) {
            var b = 56500
        }
        return roundNumber(b, 2)
    }

    function calculateKMcoefftorque(DKMInputKMSize) {
        if (a == 32) {
            var b = 0.866
        }
        if (a == 40) {
            var b = 1.063
        }
        if (a == 50) {
            var b = 1.378
        }
        if (a == 63) {
            var b = 1.693
        }
        if (a == 80) {
            var b = 2.087
        }
        if (a == 100) {
            var b = 2.48
        }
        return roundNumber(b, 2)
    }

    // http://www.practicalmachinist.com/vb/cnc-machining/calculating-hp-cut-177290/
    // Compute horsepower from ft-lbs torque and RPM (ie: via torque curve)
    function hp( torque, rpm ) { (torque * rpm) / 5252 }

    // ---------------------------------------------------------------------------------------
    // Google Charts
    //

    // var docOptions = {
    //     colorAxis: {colors: ['white', 'red']},

    //     title: 'RPM label, MRR heatmap, IPM size',
    //     hAxis: {title: 'Width of Cut'},
    //     vAxis: {title: 'Depth of Cut'},
    //     bubble: {opacity: 0.5},
    //     sizeAxis: {minValue: 0,  maxSize: 15}
    // };

    // var rpmOptions = {
    //     colorAxis: {colors: ['white', 'red']},

    //     title: 'DOC label, MRR heatmap, HP size',
    //     hAxis: {title: 'Inches per Minute'},
    //     vAxis: {title: 'Spindle RPM'},
    //     bubble: {opacity: 0.5},
    //     sizeAxis: {minValue: 0,  maxSize: 15}
    // };


    // function drawChart(doms,id,options)
    // {
    //     if ( typeof google != "undefined" )
    //     {
    //         var data = google.visualization.arrayToDataTable(doms);
    //         var chart = new google.visualization.BubbleChart(document.getElementById(id));
    //         chart.draw(data, options);
    //     }
    // }

    // --------------------------------------------------
    // Fixed random numbers; repeatable searches.
    var RandomNumbers = [
        0.91462,0.66192,0.30455,0.59594,0.03891,0.32207,0.28796,0.67158,0.52439,0.71601,
        0.59125,0.81100,0.82491,0.64369,0.43692,0.02092,0.98170,0.36273,0.06454,0.63712,
        0.80275,0.43528,0.21881,0.76301,0.20097,0.96792,0.84689,0.66060,0.54936,0.98169,
        0.67811,0.64988,0.95504,0.76376,0.85614,0.76507,0.55453,0.57270,0.94701,0.01474,
        0.28871,0.99613,0.45591,0.59791,0.12903,0.59240,0.45153,0.83908,0.39503,0.18746,
        0.01896,0.92268,0.62890,0.34323,0.04012,0.73122,0.47377,0.06595,0.23554,0.22084,
        0.14056,0.78055,0.49215,0.80463,0.34177,0.96185,0.24857,0.15614,0.02117,0.58335,
        0.11297,0.69416,0.81444,0.72165,0.94795,0.76489,0.93879,0.23709,0.37284,0.19861,
        0.12825,0.44093,0.00581,0.48536,0.30693,0.05429,0.79658,0.28788,0.92345,0.56664,
        0.48489,0.38972,0.25796,0.30869,0.56111,0.46292,0.55677,0.16965,0.10192,0.23159,
        0.54992,0.90880,0.50780,0.70681,0.76352,0.43822,0.47823,0.17273,0.05127,0.28663,
        0.52672,0.51529,0.93863,0.69337,0.95942,0.30195,0.69815,0.42729,0.51982,0.74490,
        0.55621,0.47676,0.83627,0.30962,0.06861,0.21537,0.40004,0.26721,0.49711,0.51190,
        0.04881,0.93106,0.96837,0.52371,0.83341,0.66713,0.30404,0.58954,0.70575,0.02202,
        0.67268,0.72057,0.68117,0.47395,0.63376,0.67798,0.00101,0.37965,0.71874,0.52074,
        0.34892,0.66302,0.42591,0.80901,0.35974,0.67213,0.39329,0.35661,0.49986,0.41662,
        0.55793,0.54041,0.89558,0.09029,0.30984,0.69471,0.83911,0.38219,0.00576,0.04565,
        0.51128,0.58447,0.72007,0.97376,0.92621,0.91620,0.77960,0.13165,0.22480,0.80002,
        0.45397,0.08988,0.22273,0.05195,0.15457,0.73535,0.55274,0.07452,0.63328,0.60474,
        0.83215,0.17965,0.96550,0.69991,0.03339,0.11014,0.55265,0.10242,0.63890,0.67691,
        0.98560,0.88127,0.22106,0.18448,0.37312,0.37091,0.80372,0.97807,0.65847,0.88587,
        0.73415,0.01294,0.52251,0.33376,0.82227,0.82061,0.70291,0.99032,0.18868,0.62612,
        0.94711,0.90796,0.60409,0.65683,0.36018,0.04383,0.09934,0.87549,0.60936,0.21358,
        0.27892,0.46923,0.30318,0.40409,0.08033,0.43050,0.87590,0.81113,0.68739,0.47776,
        0.47704,0.20749,0.92773,0.38052,0.69064,0.89230,0.76312,0.47728,0.39080,0.52436,
        0.41557,0.80486,0.67731,0.59995,0.26332,0.79343,0.62947,0.20015,0.88765,0.92419,
        0.56606,0.90308,0.55480,0.09534,0.60626,0.43313,0.97707,0.69650,0.58862,0.70254,
        0.41255,0.55331,0.82437,0.38957,0.03559,0.97107,0.73656,0.09337,0.03783,0.07984,
        0.16781,0.40715,0.10472,0.56364,0.02719,0.95941,0.75285,0.64217,0.99097,0.58723,
        0.51075,0.86600,0.17159,0.32602,0.07907,0.88485,0.02634,0.82703,0.41554,0.85341,
        0.28937,0.14681,0.15608,0.55030,0.37988,0.59221,0.90531,0.60306,0.56460,0.44986,
        0.70824,0.43593,0.13370,0.98087,0.44930,0.68679,0.98759,0.01962,0.01590,0.87591,
        0.32545,0.87959,0.81045,0.05155,0.57684,0.03985,0.59850,0.98599,0.32409,0.26239,
        0.73999,0.25060,0.72589,0.37374,0.56629,0.15953,0.87141,0.93333,0.03818,0.13902,
        0.56949,0.40674,0.84791,0.55318,0.30894,0.26360,0.81301,0.39655,0.51361,0.62804,
        0.75082,0.55035,0.75980,0.72376,0.01902,0.49129,0.32397,0.37634,0.56154,0.44082,
        0.28490,0.26207,0.60823,0.94728,0.41737,0.42584,0.14277,0.80474,0.28317,0.82953,
        0.87529,0.02953,0.25063,0.33815,0.73449,0.33936,0.65522,0.60259,0.82870,0.20947,
        0.95141,0.75588,0.41594,0.11669,0.50006,0.70411,0.67037,0.02440,0.58567,0.06373,
        0.93563,0.51039,0.36436,0.47353,0.71530,0.19396,0.70613,0.09289,0.86633,0.28030,
        0.31378,0.58688,0.33364,0.10714,0.07635,0.79444,0.29211,0.55263,0.34593,0.57758,
        0.74701,0.04290,0.71495,0.05763,0.48450,0.68436,0.91445,0.55864,0.76118,0.73779,
        0.65446,0.09878,0.27467,0.24999,0.58381,0.19714,0.76709,0.16391,0.05943,0.09651,
        0.07883,0.63889,0.08430,0.24177,0.59233,0.63033,0.59815,0.99926,0.78375,0.00168,
        0.28670,0.15415,0.03499,0.57137,0.21273,0.68068,0.94947,0.53374,0.86633,0.64481,
        0.16199,0.63499,0.68191,0.86881,0.03633,0.33429,0.67580,0.16451,0.70399,0.93459,
        0.62123,0.52474,0.61311,0.32921,0.09617,0.65170,0.12868,0.57744,0.81497,0.59665,
        0.75362,0.99596,0.88589,0.08701,0.22475,0.83312,0.02457,0.32487,0.07850,0.87877,
        0.29725,0.65538,0.27840,0.55513,0.66789,0.52381,0.14946,0.13256,0.47962,0.56679,
        0.17449,0.71908,0.01390,0.51659,0.17282,0.58368,0.43928,0.83613,0.00431,0.19062,
        0.78745,0.64806,0.21956,0.04588,0.07511,0.57333,0.01208,0.08648,0.32838,0.55203,
        0.41875,0.87974,0.05995,0.58421,0.96213,0.34189,0.69985,0.59849,0.83148,0.03388,
        0.58683,0.33300,0.25883,0.34758,0.39005,0.19665,0.96236,0.05609,0.24996,0.56727,
        0.40135,0.76978,0.50217,0.87948,0.11542,0.81297,0.57972,0.15608,0.60510,0.91633,
        0.57688,0.34561,0.05179,0.90593,0.00133,0.94208,0.67221,0.26239,0.44208,0.88435,
        0.65576,0.02230,0.23670,0.65838,0.44266,0.99879,0.73422,0.85959,0.56670,0.70938,
        0.41897,0.21094,0.40850,0.71654,0.98593,0.17844,0.98343,0.31011,0.43933,0.87733,
        0.32287,0.59058,0.42439,0.92020,0.09849,0.04832,0.29553,0.22253,0.88608,0.67623,
        0.87497,0.55175,0.86899,0.50207,0.46181,0.78265,0.84062,0.18141,0.41468,0.40483,
        0.08132,0.95326,0.54955,0.81734,0.05723,0.82817,0.67000,0.34114,0.91658,0.35172,
        0.77831,0.68155,0.44403,0.66657,0.90356,0.78113,0.47391,0.88227,0.02686,0.61764,
        0.76075,0.95433,0.28422,0.52201,0.95857,0.37283,0.48349,0.01839,0.67000,0.96553,
        0.98517,0.02100,0.49208,0.03192,0.16535,0.46191,0.60786,0.84152,0.00438,0.06952,
        0.75104,0.25392,0.82634,0.06899,0.30545,0.84752,0.85215,0.03404,0.89215,0.48025,
        0.02287,0.98390,0.04389,0.64797,0.50018,0.08942,0.47001,0.35475,0.35733,0.02933,
        0.97440,0.46413,0.23666,0.12061,0.30505,0.66176,0.16854,0.83614,0.08572,0.22700,
        0.32203,0.21828,0.50848,0.78480,0.18883,0.99893,0.65083,0.08901,0.58979,0.94441,
        0.12127,0.67449,0.93731,0.05801,0.23501,0.90767,0.38702,0.79337,0.07426,0.56383,
        0.86875,0.35865,0.59730,0.56450,0.49913,0.52454,0.42649,0.91906,0.54774,0.08837,
        0.06727,0.23249,0.95319,0.29199,0.08852,0.36452,0.36753,0.04306,0.22936,0.95540,
        0.84472,0.74718,0.48814,0.56974,0.58316,0.92268,0.99658,0.15215,0.58208,0.54038,
        0.88518,0.33700,0.67841,0.20735,0.40575,0.90967,0.19327,0.89667,0.29263,0.37766,
        0.33604,0.91465,0.71625,0.17730,0.58957,0.19215,0.21106,0.51558,0.53095,0.78877,
        0.64436,0.22627,0.93056,0.70630,0.63337,0.30589,0.51566,0.72247,0.81513,0.98731,
        0.48502,0.97621,0.02683,0.30736,0.71782,0.46255,0.76398,0.12989,0.63230,0.42842,
        0.24963,0.49669,0.81906,0.89952,0.06980,0.99613,0.89865,0.21426,0.60870,0.56299,
        0.53492,0.49246,0.45187,0.75288,0.17307,0.42430,0.51612,0.07071,0.86528,0.62963,
        0.91243,0.37512,0.49719,0.10786,0.45092,0.72937,0.83477,0.97578,0.25703,0.32405,
        0.07371,0.77332,0.18341,0.25825,0.99288,0.10686,0.57458,0.03298,0.38792,0.29491,
        0.46909,0.58445,0.19310,0.98290,0.50933,0.56461,0.58689,0.40186,0.66906,0.36254,
        0.42073,0.05987,0.40659,0.05262,0.51081,0.17575,0.00416,0.05403,0.68887,0.09135,
        0.66437,0.79112,0.02100,0.23159,0.39959,0.05508,0.27210,0.92070,0.87293,0.08513,
        0.51914,0.50879,0.12734,0.61058,0.79744,0.81450,0.57418,0.22541,0.80231,0.84739,
        0.70321,0.50298,0.96201,0.13822,0.72319,0.20080,0.64824,0.77566,0.74565,0.75411,
        0.89707,0.42464,0.18359,0.01162,0.77544,0.18471,0.75331,0.82831,0.44785,0.13602,
        0.83898,0.69708,0.07262,0.81585,0.00838,0.07508,0.88873,0.67069,0.15252,0.44022,
        0.24205,0.73657,0.06280,0.39958,0.84336,0.41485,0.25647,0.36363,0.25128,0.23092,
        0.51426,0.39930,0.42914,0.89041,0.90395,0.87906,0.23786,0.77998,0.02915,0.45510,
        0.89576,0.29961,0.86482,0.70445,0.76143,0.05828,0.81939,0.51494,0.27712,0.01716,
        0.59772,0.91147,0.54796,0.12197,0.03023,0.55855,0.82631,0.83086,0.28037,0.61693,
        0.12038,0.21441,0.74602,0.98145,0.25320,0.98116,0.53008,0.18137,0.96036,0.86510,
        0.57100,0.38638,0.03401,0.30085,0.39657,0.02802,0.09572,0.20766,0.99210,0.52064,
        0.31256,0.00528,0.45906,0.44546,0.25785,0.69257,0.98088,0.34744,0.16268,0.93412,
        0.10974,0.98736,0.00390,0.62063,0.54151,0.48972,0.23120,0.29541,0.35558,0.33235,
        0.44812,0.17275,0.16196,0.53451,0.03129,0.21258,0.72057,0.71755,0.49692,0.86197,
        0.37525,0.93635,0.40540,0.62532,0.08036,0.30885,0.73219,0.58337,0.88801,0.50786,
        0.92756,0.34512,0.51143,0.12133,0.33742,0.68781,0.98322,0.73581,0.26447,0.31606,
        0.48665,0.35313,0.71110,0.75513,0.15421,0.41098,0.76486,0.38185,0.99948,0.24585,
        0.66202,0.99268,0.17694,0.31011,0.79681,0.10986,0.44864,0.83508,0.33090,0.43492,
        0.07768,0.91814,0.60237,0.47273,0.36547,0.20399,0.23294,0.36995,0.70295,0.42916,
        0.68918,0.43865,0.31576,0.10358,0.06586,0.66855,0.84887,0.51415,0.02853,0.77082,
        0.55843,0.05265,0.17785,0.94183,0.15702,0.59402,0.57935,0.58702,0.29271,0.28085,
        0.84008,0.70295,0.23359,0.60605,0.90780,0.48005,0.57612,0.12813,0.71815,0.95890,
        0.69917,0.50210,0.92190,0.24975,0.24524,0.76381,0.18725,0.90802,0.12594,0.96688,
        0.99066,0.54751,0.42116,0.33854,0.38531,0.66911,0.06945,0.09446,0.96745,0.98388,
        0.43181,0.93251,0.14880,0.21787,0.65197,0.01147,0.88690,0.50025,0.23309,0.91316,
        0.22571,0.95643,0.40445,0.68510,0.35505,0.05525,0.66092,0.56556,0.41023,0.59177,
        0.32412,0.40426,0.90220,0.92666,0.09611,0.10896,0.49362,0.24889,0.35472,0.67228,
        0.81793,0.17970,0.37428,0.46258,0.17584,0.99440,0.74647,0.49914,0.23800,0.10236,
        0.02263,0.37404,0.33250,0.19629,0.00280,0.33191,0.50247,0.65865,0.15578,0.77370,
        0.28161,0.39587,0.37074,0.11133,0.05465,0.26056,0.61261,0.46813,0.94462,0.61733,
        0.08221,0.19296,0.40049,0.40933,0.16617,0.53610,0.04645,0.29108,0.80307,0.12129,
        0.89779,0.00709,0.88867,0.04021,0.74887,0.21632,0.99706,0.49483,0.39485,0.38944,
        0.00359,0.91760,0.36176,0.23877,0.16161,0.41070,0.98811,0.37982,0.80697,0.16299,
        0.02697,0.56942,0.14257,0.22687,0.41824,0.91646,0.48985,0.66718,0.51912,0.91992,
        0.98489,0.63038,0.87429,0.05269,0.94393,0.32457,0.55788,0.88044,0.02629,0.24982,
        0.22534,0.38137,0.88250,0.27267,0.27644,0.21588,0.19093,0.30033,0.94928,0.18425,
        0.85864,0.37711,0.74048,0.00608,0.69014,0.99939,0.27819,0.85699,0.01268,0.32536,
        0.66229,0.80589,0.58717,0.74176,0.32986,0.41072,0.63111,0.94241,0.70460,0.25081,
        0.93317,0.27176,0.24494,0.10080,0.84873,0.59172,0.01852,0.78416,0.43116,0.34117,
        0.59944,0.48363,0.07631,0.77471,0.91028,0.43121,0.83525,0.59118,0.61177,0.45231,
        0.98562,0.29210,0.78118,0.79653,0.54206,0.64642,0.91421,0.05190,0.13395,0.58034,
        0.73533,0.70986,0.08135,0.65960,0.90813,0.12499,0.56014,0.08646,0.49973,0.19663,
        0.46289,0.79488,0.97250,0.08856,0.93408,0.79455,0.55117,0.69876,0.58671,0.38831,
        0.04532,0.39266,0.09187,0.26720,0.59450,0.72154,0.17357,0.77361,0.34744,0.46192,
        0.03844,0.81525,0.78690,0.33233,0.92283,0.01160,0.26827,0.17048,0.74992,0.65892,
        0.35246,0.18702,0.85475,0.01151,0.68296,0.15129,0.35759,0.19388,0.48179,0.00982,
        0.04411,0.78250,0.22063,0.49042,0.54550,0.72529,0.66122,0.70229,0.20241,0.80360,
        0.25299,0.60726,0.24387,0.28326,0.82588,0.50740,0.81540,0.75049,0.62317,0.37132,
        0.95020,0.38291,0.98144,0.90429,0.79326,0.06722,0.38398,0.75649,0.26010,0.84243,
        0.18896,0.15966,0.84024,0.12129,0.06541,0.58344,0.44010,0.02222,0.05733,0.71147,
        0.00090,0.93035,0.24070,0.15102,0.12405,0.09864,0.13785,0.81072,0.08995,0.69867,
        0.41058,0.80749,0.46566,0.23544,0.86560,0.09719,0.96275,0.65193,0.47531,0.76214,
        0.32871,0.76627,0.94188,0.03482,0.83345,0.90826,0.31383,0.68835,0.34737,0.75153,
        0.30258,0.38257,0.09783,0.37419,0.23977,0.91874,0.93836,0.52281,0.06670,0.12649,
        0.36790,0.90344,0.35372,0.28314,0.59720,0.07820,0.10973,0.54888,0.67522,0.20706,
        0.06138,0.89028,0.06041,0.44186,0.15639,0.36019,0.05008,0.25320,0.27701,0.40393,
        0.16581,0.35091,0.53728,0.06953,0.93339,0.14456,0.08181,0.61420,0.49295,0.88321,
        0.00382,0.01954,0.12857,0.71213,0.85673,0.35495,0.11557,0.88898,0.24630,0.76147,
        0.25023,0.31323,0.15923,0.06789,0.04825,0.33989,0.00928,0.69606,0.87676,0.57231,
        0.86352,0.56434,0.21931,0.95862,0.94900,0.15626,0.86397,0.05265,0.33384,0.78525,
        0.05183,0.74230,0.62742,0.35739,0.52656,0.09736,0.65025,0.61043,0.98496,0.24312,
        0.28722,0.89057,0.64476,0.32790,0.15658,0.01767,0.51749,0.71932,0.30247,0.68518,
        0.50290,0.53841,0.84992,0.14254,0.60580,0.51995,0.44938,0.61624,0.41712,0.97413,
        0.38126,0.03965,0.49802,0.31651,0.39173,0.18232,0.45912,0.23220,0.68687,0.19629,
        0.33668,0.04497,0.02554,0.92990,0.33313,0.27311,0.51981,0.09888,0.11171,0.67127,
        0.57734,0.54988,0.61298,0.28112,0.40123,0.40352,0.79587,0.14365,0.60086,0.82207,
        0.79640,0.36184,0.76093,0.51088,0.74467,0.14513,0.26633,0.83344,0.88357,0.31537,
        0.28668,0.59667,0.69277,0.50931,0.58727,0.14584,0.43686,0.97318,0.75196,0.39816,
        0.92892,0.41296,0.47896,0.83908,0.32897,0.83707,0.84147,0.30769,0.48141,0.70841,
        0.79345,0.60505,0.63628,0.00850,0.74409,0.57393,0.39622,0.00930,0.72534,0.31877,
        0.38465,0.64646,0.53275,0.66155,0.43966,0.39282,0.23310,0.76201,0.10457,0.44237,
        0.60076,0.07032,0.80775,0.83169,0.37032,0.42541,0.40272,0.85008,0.67414,0.16418,
        0.67428,0.71925,0.67147,0.56476,0.00697,0.05934,0.16944,0.81116,0.65951,0.10097,
        0.98669,0.93730,0.99191,0.95107,0.91664,0.88503,0.55175,0.47552,0.41018,0.89383,
        0.14184,0.52262,0.51661,0.92923,0.86355,0.27876,0.19662,0.75224,0.65834,0.52137,
        0.85274,0.53412,0.05485,0.41403,0.81033,0.62859,0.66938,0.27490,0.52610,0.22811,
        0.50492,0.44180,0.50143,0.15107,0.24709,0.95607,0.23392,0.93363,0.56508,0.29218,
        0.05386,0.73307,0.89109,0.77119,0.36063,0.28855,0.27449,0.61344,0.59955,0.33079,
        0.68456,0.80973,0.30129,0.38402,0.57075,0.11984,0.64327,0.86136,0.57996,0.54364,
        0.28667,0.71931,0.07748,0.55212,0.69291,0.70722,0.52153,0.21474,0.72967,0.42466,
        0.80098,0.11383,0.13948,0.98249,0.36151,0.59841,0.36261,0.05263,0.31778,0.49688,
        0.28147,0.48716,0.77714,0.88175,0.68482,0.48905,0.28539,0.85948,0.63813,0.52488,
        0.64557,0.64465,0.49017,0.78412,0.35806,0.36990,0.94611,0.01009,0.58352,0.18202,
        0.49401,0.95450,0.83965,0.17916,0.48407,0.54032,0.60888,0.65535,0.32908,0.05728,
        0.65571,0.93608,0.61976,0.35943,0.13125,0.81198,0.42989,0.08639,0.47669,0.20789,
        0.72412,0.38748,0.72840,0.26039,0.57511,0.49250,0.07444,0.41966,0.84685,0.74327,
        0.41567,0.53965,0.10757,0.37694,0.24385,0.17596,0.79817,0.43492,0.36549,0.47151,
        0.10128,0.66060,0.87183,0.07784,0.53101,0.14471,0.28383,0.53318,0.99507,0.77852,
        0.98565,0.39858,0.96852,0.28364,0.90081,0.23934,0.46245,0.70091,0.86248,0.23145,
        0.67107,0.74166,0.28235,0.77140,0.53701,0.33149,0.53248,0.97259,0.98753,0.00925,
        0.92002,0.34251,0.26315,0.58384,0.25710,0.25267,0.58531,0.59623,0.80600,0.03644,
        0.39151,0.68656,0.81498,0.68014,0.50352,0.92352,0.95027,0.10871,0.88865,0.51806,
        0.67724,0.00975,0.12406,0.11359,0.04704,0.98827,0.28054,0.02170,0.40425,0.59944,
        0.70494,0.35555,0.24743,0.46783,0.09939,0.00215,0.84596,0.26879,0.37049,0.77041,
        0.24542,0.82142,0.95337,0.85358,0.97780,0.92258,0.70291,0.95252,0.13418,0.83714,
        0.98864,0.02077,0.45412,0.55248,0.32976,0.61282,0.73968,0.00363,0.76342,0.24351,
        0.21131,0.48031,0.15191,0.99983,0.38880,0.33845,0.80344,0.88545,0.70254,0.95602,
        0.10640,0.02390,0.31869,0.59656,0.35837,0.89794,0.59619,0.47388,0.60888,0.26090,
        0.18479,0.84738,0.12886,0.21978,0.01997,0.41989,0.07000,0.26068,0.37412,0.65851,
        0.98349,0.66352,0.68286,0.91392,0.13048,0.83645,0.08126,0.37457,0.93548,0.58925,
        0.45674,0.95977,0.50916,0.26069,0.35374,0.22924,0.89833,0.91659,0.24988,0.26637,
        0.60875,0.54331,0.56408,0.27900,0.99023,0.27556,0.25427,0.35350,0.27374,0.21806,
        0.01545,0.39671,0.40663,0.34733,0.89880,0.80534,0.34495,0.31274,0.63786,0.81330,
        0.13045,0.69545,0.09036,0.78496,0.90539,0.42913,0.98217,0.94598,0.99959,0.63837,
        0.57485,0.17319,0.36176,0.10837,0.96865,0.50110,0.90122,0.96413,0.50021,0.94511,
        0.75634,0.90758,0.09740,0.09004,0.11231,0.53790,0.51336,0.64742,0.95367,0.86353,
        0.07746,0.84639,0.05605,0.10317,0.97327,0.08997,0.59651,0.26908,0.08169,0.78268,
        0.99360,0.82740,0.11199,0.61476,0.97578,0.93825,0.08456,0.87496,0.42077,0.39292,
        0.22585,0.55568,0.20884,0.38557,0.98974,0.11348,0.18907,0.68381,0.22873,0.75223,
        0.37075,0.59570,0.50456,0.00784,0.62076,0.36956,0.14952,0.23058,0.47297,0.30890,
        0.96845,0.28474,0.13740,0.93632,0.40571,0.41520,0.43412,0.99821,0.59226,0.76677,
        0.17138,0.96653,0.93527,0.48431,0.43717,0.96418,0.81562,0.67044,0.38004,0.71761,
        0.51871,0.73253,0.31786,0.22280,0.73928,0.81170,0.43183,0.30064,0.87347,0.05394,
        0.87853,0.11255,0.83948,0.45731,0.88410,0.00967,0.35258,0.90876,0.27225,0.79623,
        0.42146,0.81033,0.92208,0.60259,0.32965,0.38716,0.85147,0.08348,0.51900,0.36787,
        0.97848,0.58414,0.60230,0.23321,0.12598,0.24961,0.19713,0.63968,0.50331,0.79210,
        0.39594,0.94247,0.72449,0.77668,0.46501,0.96549,0.40343,0.83718,0.79996,0.29630,
        0.50458,0.19252,0.25601,0.41971,0.92143,0.19756,0.71845,0.94642,0.20528,0.43346,
        0.18202,0.04154,0.97322,0.01886,0.66739,0.91272,0.28712,0.40667,0.01901,0.87891,
        0.21403,0.92016,0.00032,0.10786,0.85397,0.67767,0.13090,0.58449,0.35223,0.35709,
        0.39466,0.25174,0.80120,0.45910,0.28877,0.55199,0.48054,0.34259,0.68055,0.78925,
        0.58484,0.32616,0.59234,0.83115,0.44422,0.57613,0.34433,0.67452,0.25616,0.33488,
        0.45098,0.30958,0.51565,0.28231,0.28871,0.13498,0.65615,0.46873,0.83101,0.89983,
        0.89495,0.30950,0.68151,0.77846,0.91466,0.58940,0.22650,0.71992,0.80609,0.28927,
        0.97531,0.65672,0.64836,0.31770,0.06059,0.50560,0.20806,0.90758,0.42964,0.14854,
        0.50249,0.52010,0.47423,0.74267,0.39062,0.58822,0.71806,0.77582,0.93056,0.32693,
        0.70955,0.25757,0.97418,0.13963,0.45208,0.31578,0.35669,0.85783,0.54478,0.25464,
        0.08332,0.16553,0.70381,0.82274,0.11523,0.08040,0.48771,0.03816,0.71344,0.29040,
        0.85956,0.42261,0.81190,0.47766,0.68492,0.90764,0.56020,0.50052,0.38633,0.99346,
        0.00128,0.45031,0.75354,0.96447,0.83112,0.15122,0.34324,0.09540,0.32502,0.62930,
        0.99282,0.81834,0.80903,0.44138,0.71988,0.76303,0.50532,0.52478,0.68234,0.43163,
        0.18671,0.40568,0.93373,0.02391,0.83822,0.18697,0.42406,0.59012,0.44250,0.72559,
        0.06854,0.25602,0.08127,0.80494,0.73510,0.73820,0.77614,0.90979,0.68580,0.74784,
        0.88008,0.41886,0.34841,0.16700,0.37462,0.64481,0.29131,0.07408,0.12822,0.17170,
        0.92821,0.79359,0.02737,0.36670,0.78884,0.15041,0.90515,0.77608,0.15742,0.01960,
        0.36045,0.35444,0.50300,0.08055,0.88657,0.12197,0.40390,0.40753,0.20923,0.89597,
        0.60320,0.15890,0.37176,0.20120,0.42276,0.16307,0.89907,0.32755,0.01092,0.64203,
        0.32249,0.77440,0.80152,0.66156,0.45356,0.99729,0.12221,0.15233,0.05801,0.45624,
        0.10539,0.50714,0.99984,0.45350,0.92736,0.82705,0.50059,0.14471,0.92953,0.86255,
        0.89057,0.40884,0.36007,0.57608,0.11621,0.97027,0.31542,0.03814,0.31196,0.28092,
        0.95777,0.06169,0.94494,0.19054,0.23832,0.57822,0.39758,0.36011,0.16545,0.26357,
        0.36546,0.70649,0.12287,0.33306,0.11729,0.90542,0.86482,0.74236,0.48835,0.12574,
        0.59384,0.25480,0.46096,0.71925,0.96092,0.96503,0.32258,0.54885,0.91911,0.90566,
        0.68646,0.00164,0.10821,0.30544,0.10988,0.50433,0.85190,0.91657,0.65140,0.53500,
        0.90812,0.58318,0.47130,0.70822,0.82916,0.88461,0.49828,0.49994,0.16020,0.25413,
        0.26074,0.57390,0.73338,0.44755,0.21242,0.47310,0.99875,0.61604,0.26975,0.64808,
        0.67467,0.52364,0.82237,0.40764,0.99705,0.64219,0.17836,0.39856,0.50015,0.95515,
        0.26219,0.64729,0.57131,0.30675,0.39621,0.02974,0.98782,0.04372,0.16517,0.27468,
        0.26610,0.51477,0.68880,0.25144,0.93177,0.71593,0.10862,0.34473,0.75366,0.00040,
        0.73313,0.17708,0.57587,0.30733,0.07911,0.80392,0.62873,0.80631,0.99744,0.77669,
        0.10298,0.20326,0.17777,0.14612,0.33130,0.20792,0.58949,0.56085,0.13658,0.82465,
        0.83519,0.10593,0.77904,0.19538,0.96794,0.42105,0.46203,0.69716,0.05544,0.94017,
        0.54152,0.87694,0.66137,0.80248,0.42436,0.59192,0.45871,0.09832,0.63837,0.41662,
        0.38947,0.63490,0.70968,0.97609,0.14217,0.33276,0.29321,0.36978,0.23086,0.69741,
        0.46722,0.26169,0.62843,0.54955,0.22555,0.52969,0.73224,0.34291,0.97906,0.59075,
        0.42142,0.95050,0.31259,0.64840,0.10318,0.75801,0.33451,0.14523,0.93886,0.26738,
        0.70297,0.64527,0.89130,0.18417,0.81630,0.21998,0.84111,0.13894,0.71460,0.16637,
        0.78218,0.77592,0.95543,0.54687,0.02591,0.93171,0.09838,0.60803,0.41866,0.02183,
        0.46192,0.60864,0.80835,0.55517,0.50015,0.96792,0.38403,0.90407,0.48830,0.93043,
        0.05586,0.07212,0.20253,0.13674,0.74359,0.22236,0.93303,0.58756,0.29754,0.15514,
        0.47911,0.49403,0.78923,0.75808,0.74070,0.41766,0.07751,0.68976,0.14256,0.92126,
        0.88135,0.20425,0.40628,0.67547,0.07170,0.07530,0.11912,0.59547,0.53293,0.03730,
        0.14023,0.11870,0.73770,0.02392,0.13117,0.17675,0.13003,0.75628,0.40161,0.76301,
        0.51711,0.90895,0.82012,0.25295,0.93345,0.16534,0.75622,0.79463,0.86004,0.96303,
        0.89157,0.15471,0.25586,0.62533,0.26678,0.37873,0.59117,0.87701,0.11473,0.50428,
        0.95919,0.45014,0.87215,0.35195,0.38700,0.60027,0.25825,0.11123,0.66661,0.87373,
        0.46269,0.03719,0.38368,0.39337,0.29436,0.07855,0.33372,0.26353,0.60877,0.66919,
        0.18520,0.43366,0.45346,0.23214,0.07344,0.50606,0.14943,0.16897,0.79119,0.52476,
        0.96112,0.23732,0.37920,0.74041,0.09819,0.25550,0.21405,0.71066,0.53954,0.01527,
        0.14089,0.86561,0.57320,0.13287,0.80486,0.84513,0.00552,0.32294,0.09809,0.49737,
        0.70856,0.24126,0.55763,0.41739,0.54698,0.60968,0.62526,0.30026,0.75395,0.80998,
        0.91142,0.18463,0.50996,0.51373,0.99313,0.87089,0.81964,0.20079,0.81984,0.41232,
        0.77831,0.61201,0.50121,0.59797,0.97378,0.27992,0.10750,0.77301,0.07794,0.28638,
        0.12557,0.17506,0.64913,0.30698,0.38289,0.20445,0.78773,0.81975,0.57668,0.69172,
        0.56620,0.07901,0.02725,0.27768,0.08914,0.08524,0.91175,0.47886,0.62979,0.31807,
        0.02901,0.87612,0.53652,0.44166,0.09604,0.13409,0.50610,0.54052,0.68319,0.23617,
        0.38020,0.69871,0.15786,0.40288,0.83728,0.89637,0.42548,0.65029,0.22428,0.26507,
        0.83155,0.84123,0.30055,0.71694,0.32036,0.38325,0.85134,0.84265,0.83313,0.43570,
        0.96888,0.75908,0.97291,0.60235,0.29589,0.28039,0.16314,0.60653,0.68031,0.38431,
        0.88377,0.37246,0.49875,0.45080,0.08112,0.26970,0.37288,0.16108,0.51683,0.01648,
        0.12431,0.26252,0.64639,0.88365,0.59224,0.62851,0.59914,0.39227,0.37271,0.17226,
        0.96946,0.65644,0.62890,0.20978,0.42257,0.88654,0.86908,0.80932,0.56887,0.33922,
        0.99235,0.51364,0.16685,0.17673,0.96158,0.57599,0.47773,0.28160,0.17880,0.51204,
        0.51336,0.06148,0.01071,0.33716,0.99470,0.67498,0.93978,0.33245,0.06928,0.91062,
        0.50148,0.56233,0.22375,0.15936,0.50856,0.65301,0.37176,0.53529,0.06077,0.53342,
        0.79744,0.21953,0.49141,0.93873,0.49132,0.52919,0.71182,0.48156,0.42804,0.04643,
        0.38078,0.00717,0.50440,0.38148,0.94778,0.76613,0.18122,0.78948,0.89736,0.66177,
        0.35424,0.91240,0.45658,0.45949,0.61663,0.37552,0.61810,0.38120,0.86992,0.83209,
        0.57888,0.95049,0.19017,0.32032,0.59724,0.30287,0.96282,0.47369,0.83137,0.43012,
        0.56214,0.20837,0.93731,0.98908,0.27027,0.00122,0.07730,0.37261,0.70615,0.76666,
        0.51718,0.71387,0.76575,0.64328,0.17630,0.37523,0.96309,0.70835,0.33423,0.25906,
        0.10524,0.75312,0.19560,0.97008,0.43473,0.77206,0.16759,0.45764,0.72931,0.74604,
        0.51457,0.27112,0.36159,0.63251,0.51950,0.97277,0.99029,0.21480,0.40468,0.56977,
        0.37946,0.60841,0.04185,0.05077,0.82434,0.77383,0.91691,0.24231,0.79923,0.34324,
        0.90497,0.23630,0.73764,0.43311,0.15859,0.58246,0.30443,0.88482,0.81557,0.28807,
        0.12650,0.55238,0.29178,0.42227,0.71123,0.83941,0.64100,0.78332,0.20072,0.67650,
        0.83512,0.65470,0.68511,0.52604,0.84681,0.14932,0.02982,0.80280,0.10131,0.02122,
        0.55902,0.30707,0.20454,0.11028,0.48176,0.88113,0.85212,0.77754,0.64744,0.52042,
        0.47700,0.78785,0.07346,0.59744,0.50307,0.10095,0.70088,0.68966,0.03787,0.94356,
        0.00283,0.74164,0.45970,0.35239,0.39530,0.93738,0.63266,0.10136,0.88184,0.71049,
        0.41762,0.55663,0.00108,0.77780,0.73827,0.53874,0.94000,0.94641,0.70814,0.71384,
        0.62608,0.71445,0.22787,0.38455,0.71801,0.36290,0.02180,0.80572,0.67713,0.31851,
        0.29841,0.31182,0.52090,0.05733,0.09156,0.60962,0.43476,0.71380,0.86758,0.56396,
        0.15032,0.86202,0.16786,0.68384,0.88543,0.64406,0.89747,0.30250,0.68550,0.53417,
        0.36747,0.13742,0.20605,0.54835,0.35166,0.51475,0.33233,0.63566,0.22829,0.04772,
        0.54510,0.32035,0.74312,0.96956,0.61020,0.40336,0.05198,0.63895,0.99499,0.67734,
        0.47970,0.95956,0.39605,0.16071,0.86655,0.58518,0.90021,0.31470,0.46428,0.81813,
        0.59518,0.07145,0.09091,0.05083,0.89572,0.27151,0.65672,0.44932,0.45841,0.28625,
        0.23344,0.33212,0.32018,0.18335,0.55456,0.35912,0.81503,0.78297,0.20656,0.21266,
        0.89854,0.34775,0.79947,0.92622,0.74110,0.45133,0.08937,0.39653,0.83850,0.77834,
        0.36661,0.90064,0.43270,0.22291,0.42038,0.63204,0.73535,0.67330,0.04370,0.36856,
        0.30356,0.29707,0.35235,0.38958,0.92979,0.97401,0.15718,0.67140,0.57669,0.76369,
        0.25132,0.20667,0.21322,0.93954,0.75207,0.01777,0.88940,0.17348,0.57177,0.06370,
        0.02502,0.91298,0.68297,0.77623,0.68152,0.85666,0.09004,0.40343,0.53638,0.70517,
        0.32291,0.68739,0.38596,0.04072,0.82798,0.65770,0.26516,0.27171,0.84728,0.48354,
        0.69152,0.06816,0.24885,0.39452,0.11640,0.60908,0.29976,0.65405,0.39724,0.26488,
        0.55761,0.44891,0.99294,0.04555,0.89740,0.34490,0.62787,0.26008,0.18745,0.65067,
        0.37068,0.35268,0.28168,0.63058,0.43010,0.80836,0.80475,0.01242,0.48306,0.35332,
        0.67284,0.64661,0.01892,0.41496,0.41445,0.49128,0.00925,0.95170,0.13430,0.32106,
        0.19373,0.31470,0.39780,0.68723,0.41058,0.76148,0.40430,0.69325,0.69379,0.60564,
        0.56467,0.09172,0.30979,0.75763,0.00176,0.05794,0.51237,0.58801,0.55221,0.74955,
        0.55759,0.62774,0.56343,0.42335,0.43930,0.60941,0.15222,0.44753,0.88101,0.74866,
        0.61931,0.02118,0.35137,0.96687,0.39892,0.79302,0.25822,0.96428,0.26337,0.85705,
        0.02010,0.66672,0.49940,0.79575,0.41421,0.59008,0.42673,0.53947,0.45648,0.09285,
        0.93864,0.81611,0.08189,0.32046,0.71008,0.87581,0.06215,0.88440,0.34127,0.99326,
        0.92323,0.96433,0.98263,0.97338,0.10650,0.57343,0.92187,0.51637,0.25484,0.18509,
        0.20445,0.83407,0.29943,0.78343,0.60614,0.35210,0.97261,0.67046,0.17934,0.68063,
        0.47905,0.03957,0.15471,0.29186,0.31995,0.40818,0.19517,0.50308,0.68400,0.49122,
        0.87176,0.43188,0.39405,0.99320,0.75877,0.56337,0.12985,0.09778,0.73048,0.44954,
        0.53486,0.14228,0.88242,0.84666,0.85924,0.07844,0.99730,0.28920,0.99115,0.84158,
        0.62891,0.69747,0.08506,0.67668,0.68707,0.12071,0.50833,0.80332,0.87229,0.12899,
        0.49647,0.54037,0.43111,0.68410,0.73244,0.15697,0.48122,0.54384,0.04705,0.26811,
        0.59015,0.38346,0.57492,0.55099,0.38207,0.85451,0.99479,0.92278,0.69432,0.74354,
        0.93268,0.09078,0.20872,0.24184,0.21337,0.56282,0.54206,0.09218,0.40794,0.78864,
        0.49617,0.03977,0.04424,0.09236,0.54010,0.58192,0.92246,0.45160,0.62489,0.48463,
        0.20909,0.98062,0.11653,0.91409,0.37064,0.18273,0.97301,0.31734,0.55220,0.65166,
        0.28884,0.37861,0.70604,0.92193,0.98338,0.47663,0.63226,0.59510,0.71924,0.07281,
        0.10578,0.70179,0.10252,0.37177,0.43309,0.49858,0.83900,0.41255,0.10752,0.54440,
        0.79845,0.47295,0.71287,0.95288,0.87405,0.29893,0.86335,0.17492,0.11453,0.20757,
        0.76140,0.53034,0.85380,0.55384,0.90528,0.97755,0.46622,0.40090,0.58489,0.28739,
        0.93511,0.48766,0.06671,0.86985,0.63791,0.74917,0.78788,0.99207,0.62369,0.71238,
        0.45465,0.02111,0.18673,0.06352,0.67172,0.62716,0.72467,0.56344,0.61688,0.59048,
        0.71048,0.27303,0.31918,0.96987,0.10458,0.74354,0.29895,0.91085,0.68669,0.42512,
        0.68484,0.29868,0.59672,0.05169,0.43522,0.79398,0.83971,0.17164,0.96058,0.52838,
        0.63185,0.31088,0.26873,0.88293,0.24311,0.47885,0.73584,0.32375,0.42641,0.85748,
        0.74430,0.22741,0.61418,0.54966,0.72219,0.99297,0.81015,0.20586,0.56935,0.50781,
        0.50768,0.19635,0.06161,0.21138,0.02526,0.75129,0.58715,0.58389,0.36589,0.15205,
        0.48826,0.87636,0.07902,0.62460,0.35679,0.29365,0.63190,0.05936,0.86290,0.64424,
        0.48207,0.06178,0.08468,0.67831,0.38326,0.12421,0.84992,0.94985,0.45419,0.90172,
        0.30179,0.05926,0.19300,0.67343,0.75613,0.55962,0.92975,0.07562,0.93148,0.64250,
        0.17498,0.10418,0.80110,0.95900,0.94478,0.20109,0.64222,0.57664,0.42071,0.96361,
        0.33848,0.12490,0.23779,0.64434,0.62984,0.64003,0.28459,0.14690,0.79777,0.48398,
        0.14621,0.66377,0.22381,0.98293,0.22468,0.45219,0.36625,0.10761,0.13064,0.49817,
        0.96208,0.60045,0.15590,0.98041,0.68043,0.44424,0.50888,0.51284,0.02906,0.46201,
        0.52284,0.11849,0.04658,0.13995,0.23174,0.76695,0.20114,0.47316,0.54913,0.09417,
        0.95997,0.74796,0.78270,0.61534,0.69450,0.69554,0.37039,0.34064,0.94228,0.37793,
        0.53346,0.20810,0.55947,0.50070,0.00787,0.15938,0.96668,0.58580,0.13734,0.00122,
        0.51623,0.58361,0.38968,0.41942,0.99017,0.05492,0.79271,0.64155,0.37620,0.01166,
        0.87681,0.28132,0.36267,0.86933,0.45827,0.83934,0.44372,0.73485,0.00081,0.18414,
        0.13247,0.42987,0.35243,0.09176,0.54257,0.23308,0.37027,0.58374,0.51745,0.31397,
        0.31862,0.37046,0.56185,0.22614,0.95306,0.18053,0.06167,0.62994,0.88877,0.13673,
        0.66568,0.62239,0.19145,0.62525,0.24690,0.66638,0.12676,0.29728,0.56135,0.13176,
        0.65704,0.94066,0.57853,0.88773,0.58411,0.96409,0.47046,0.21889,0.20255,0.14780,
        0.41545,0.57649,0.94973,0.13155,0.69741,0.32220,0.81766,0.83489,0.06345,0.67306,
        0.22588,0.63417,0.94001,0.51472,0.64560,0.65713,0.90159,0.61397,0.51239,0.99815,
        0.73659,0.03235,0.86792,0.00589,0.56112,0.21917,0.73106,0.05011,0.69414,0.34544,
        0.41411,0.33527,0.42659,0.92930,0.87238,0.39622,0.39209,0.69937,0.70338,0.88464,
        0.97838,0.94361,0.59656,0.13505,0.10621,0.30005,0.87546,0.78511,0.74658,0.05935,
        0.27088,0.41738,0.74717,0.56996,0.21750,0.78850,0.89541,0.26350,0.77539,0.71630,
        0.65829,0.15063,0.74414,0.10691,0.70790,0.37743,0.65910,0.92087,0.16699,0.57728,
        0.13772,0.10126,0.49026,0.30546,0.47849,0.61655,0.03456,0.80143,0.50571,0.80699,
        0.66564,0.68799,0.40059,0.16582,0.19863,0.98728,0.66235,0.53531,0.07652,0.01000,
        0.40249,0.45212,0.45302,0.25754,0.89156,0.03825,0.76560,0.46575,0.64936,0.40051,
        0.95942,0.31467,0.39818,0.97572,0.75442,0.13041,0.88314,0.63826,0.73544,0.11309,
        0.90446,0.67294,0.58944,0.23940,0.90368,0.90866,0.51358,0.00837,0.09897,0.40649,
        0.67507,0.62627,0.47459,0.10141,0.61565,0.05897,0.89488,0.70728,0.66310,0.61984,
        0.23575,0.01273,0.73711,0.40648,0.70463,0.41869,0.41815,0.95143,0.45442,0.19861,
        0.78604,0.91006,0.18809,0.49821,0.32860,0.47294,0.69716,0.53434,0.17096,0.46081,
        0.18120,0.80076,0.98268,0.73654,0.75445,0.34382,0.18242,0.65203,0.76206,0.33214,
        0.47899,0.73681,0.40006,0.21161,0.36251,0.73091,0.66168,0.71073,0.89126,0.36607,
        0.81732,0.84135,0.00711,0.00766,0.47614,0.82577,0.65668,0.38365,0.77414,0.57358,
        0.19528,0.14768,0.38754,0.93057,0.90746,0.94996,0.87893,0.42631,0.99031,0.02269,
        0.35045,0.65884,0.01503,0.02609,0.49944,0.77169,0.70701,0.04647,0.95109,0.70248,
        0.86656,0.18969,0.17652,0.01201,0.38977,0.17116,0.39618,0.13905,0.64318,0.66806,
        0.61486,0.86824,0.89590,0.96971,0.33858,0.64730,0.11955,0.63897,0.58269,0.14455,
        0.22875,0.48038,0.49659,0.09891,0.75421,0.10025,0.30253,0.08192,0.01524,0.73909,
        0.27413,0.26487,0.09038,0.85886,0.16504,0.66427,0.27222,0.17530,0.83875,0.62464,
        0.23656,0.44002,0.84788,0.49032,0.85627,0.29729,0.36439,0.51648,0.44659,0.96756,
        0.17176,0.07438,0.24140,0.34255,0.39617,0.11715,0.06872,0.31588,0.27558,0.68957,
        0.51930,0.81916,0.54400,0.98931,0.38309,0.08461,0.94285,0.11649,0.76652,0.11387,
        0.96215,0.18496,0.09725,0.19652,0.16119,0.91088,0.17319,0.59257,0.32186,0.14295,
        0.51929,0.16966,0.24722,0.05328,0.57790,0.86921,0.23388,0.86926,0.67798,0.36434,
        0.11861,0.09422,0.30302,0.16862,0.32814,0.13789,0.90955,0.75581,0.54553,0.15811,
        0.43532,0.95925,0.44741,0.70094,0.68063,0.03350,0.46336,0.41899,0.94610,0.28153,
        0.66211,0.74609,0.66684,0.07741,0.67882,0.91175,0.29562,0.44754,0.06329,0.08962,
        0.35660,0.11259,0.55152,0.79169,0.41623,0.03799,0.54070,0.84355,0.69970,0.09246,
        0.48290,0.40607,0.21866,0.37207,0.00312,0.54479,0.57008,0.11169,0.29464,0.79068,
        0.01627,0.87605,0.74789,0.98496,0.06251,0.89949,0.82859,0.45482,0.51146,0.02646,
        0.93674,0.22890,0.89246,0.69407,0.35022,0.56796,0.23899,0.79352,0.38486,0.56030,
        0.41901,0.04901,0.58764,0.91135,0.61071,0.76066,0.12034,0.34259,0.05997,0.37239,
        0.48814,0.20790,0.95614,0.34596,0.42092,0.03356,0.11911,0.24945,0.02451,0.69348,
        0.20353,0.80116,0.28522,0.84181,0.29467,0.84944,0.63278,0.04314,0.09589,0.91416,
        0.54524,0.76342,0.38900,0.96768,0.11391,0.01531,0.08650,0.59073,0.07745,0.98709,
        0.98865,0.50336,0.08094,0.42741,0.30850,0.74115,0.81931,0.90600,0.13452,0.42402,
        0.28410,0.32610,0.26299,0.14771,0.54824,0.22477,0.25158,0.51746,0.39556,0.46542,
        0.12028,0.23873,0.63026,0.89964,0.85778,0.48180,0.08602,0.45618,0.77874,0.94485,
        0.19509,0.90032,0.82148,0.15455,0.47519,0.19979,0.07582,0.06359,0.44491,0.03169,
        0.18716,0.93145,0.28811,0.46989,0.79576,0.80762,0.05375,0.30362,0.83881,0.67578,
        0.29931,0.75500,0.36853,0.46289,0.86457,0.58733,0.52050,0.66911,0.89703,0.72553,
        0.40450,0.33210,0.34097,0.54634,0.98383,0.40401,0.84931,0.93837,0.45944,0.38944,
        0.48072,0.08051,0.28157,0.26980,0.60409,0.64237,0.67428,0.32240,0.14799,0.77131,
        0.47723,0.43177,0.70537,0.79805,0.18428,0.88631,0.03138,0.06672,0.28990,0.45508,
        0.15742,0.67468,0.44203,0.74757,0.68483,0.19392,0.44408,0.47366,0.81906,0.63813,
        0.84887,0.24111,0.35829,0.03806,0.74383,0.95528,0.16006,0.99277,0.33929,0.71812,
        0.57537,0.47558,0.14099,0.36334,0.96173,0.99064,0.81274,0.40967,0.66487,0.90007,
        0.31682,0.26624,0.79367,0.37114,0.55750,0.98198,0.70324,0.92920,0.54665,0.69509,
        0.34870,0.04471,0.06106,0.20933,0.57502,0.53083,0.86713,0.80058,0.96814,0.78352,
        0.85157,0.44005,0.10839,0.05669,0.81553,0.10977,0.93922,0.03268,0.26488,0.78174,
        0.49258,0.92188,0.26068,0.93351,0.39693,0.20509,0.28174,0.18124,0.43456,0.91846,
        0.09499,0.72544,0.91215,0.07330,0.82960,0.82520,0.76166,0.40138,0.80725,0.44317,
        0.09818,0.12164,0.19369,0.53711,0.42746,0.83508,0.20556,0.21249,0.81759,0.97190,
        0.43175,0.09649,0.12776,0.43908,0.80999,0.84549,0.82165,0.24580,0.93701,0.65598,
        0.98377,0.92076,0.68459,0.01319,0.90407,0.47764,0.54404,0.68229,0.99959,0.53355,
        0.72810,0.12361,0.90138,0.94026,0.82181,0.09656,0.25086,0.94908,0.69309,0.20595,
        0.12171,0.49776,0.44870,0.54011,0.01178,0.68123,0.45290,0.35180,0.03420,0.84808,
        0.81378,0.94119,0.27739,0.05062,0.28598,0.51397,0.30102,0.76890,0.23910,0.80870,
        0.38826,0.92767,0.19716,0.71392,0.48395,0.22999,0.46738,0.92850,0.71456,0.74262,
        0.54545,0.95844,0.00762,0.48541,0.30965,0.38811,0.60652,0.50070,0.49766,0.41641,
        0.21152,0.50873,0.59744,0.10573,0.06832,0.79077,0.07776,0.65638,0.57260,0.38469,
        0.83397,0.28914,0.86256,0.02572,0.83108,0.99583,0.43070,0.52042,0.18894,0.50046,
        0.00214,0.40290,0.37325,0.26285,0.79875,0.78963,0.73136,0.25241,0.83672,0.32290,
        0.34316,0.52093,0.08973,0.97298,0.04511,0.31194,0.19077,0.25482,0.52960,0.55784,
        0.84256,0.10796,0.62154,0.13696,0.26019,0.28655,0.19111,0.18918,0.77873,0.61154,
        0.67385,0.12195,0.22464,0.84810,0.83845,0.67756,0.77197,0.28878,0.26767,0.57834,
        0.78240,0.34642,0.99939,0.81797,0.56279,0.59093,0.91236,0.62518,0.06510,0.69994,
        0.73523,0.49038,0.29995,0.73597,0.00766,0.41626,0.63907,0.01108,0.92864,0.73017,
        0.24100,0.55518,0.79009,0.37909,0.55047,0.86506,0.61232,0.61722,0.19380,0.17876,
        0.67375,0.39178,0.62121,0.99330,0.85802,0.53442,0.53111,0.92402,0.12997,0.07342,
        0.45275,0.28959,0.99546,0.59648,0.86027,0.99922,0.50039,0.61397,0.84470,0.41748,
        0.18072,0.29972,0.68003,0.88648,0.38795,0.81911,0.58529,0.49701,0.58347,0.69358,
        0.60648,0.51691,0.52038,0.29620,0.82083,0.60913,0.71285,0.62479,0.00018,0.60144,
        0.23072,0.95682,0.46107,0.10615,0.65121,0.85488,0.07655,0.73041,0.94930,0.26188,
        0.32753,0.96636,0.21553,0.10177,0.83147,0.10531,0.35186,0.88496,0.00189,0.68121,
        0.31585,0.30632,0.36413,0.01601,0.05822,0.71974,0.58137,0.41335,0.03033,0.67455,
        0.42923,0.42662,0.02612,0.40725,0.79824,0.41372,0.16646,0.29640,0.30054,0.28336,
        0.03468,0.80872,0.21039,0.93599,0.32794,0.39162,0.27777,0.40774,0.90210,0.09985,
        0.42005,0.13670,0.75677,0.48385,0.41889,0.08819,0.33201,0.41227,0.52770,0.69937,
        0.47011,0.05341,0.32984,0.73361,0.53316,0.19794,0.27814,0.17071,0.46133,0.46975,
        0.09380,0.20200,0.00682,0.74228,0.60583,0.24747,0.98496,0.25423,0.67180,0.66745,
        0.14658,0.50188,0.53648,0.50198,0.19488,0.97416,0.35704,0.13887,0.54489,0.19247,
        0.65190,0.28478,0.65546,0.31867,0.11459,0.99359,0.15109,0.80296,0.57523,0.79260,
        0.49503,0.15738,0.88885,0.13925,0.67526,0.96139,0.18352,0.53995,0.22129,0.63257,
        0.21050,0.66722,0.88258,0.32854,0.50462,0.72267,0.46821,0.58561,0.68514,0.11075,
        0.67263,0.94488,0.50557,0.21157,0.19388,0.86852,0.19567,0.67129,0.08818,0.70687,
        0.22945,0.16460,0.09890,0.34128,0.90033,0.02604,0.64805,0.39809,0.98763,0.49581,
        0.28482,0.60589,0.35847,0.58033,0.64853,0.95132,0.56459,0.68926,0.42216,0.77777,
        0.36615,0.27772,0.32788,0.86702,0.64229,0.69630,0.94752,0.84538,0.33352,0.33142,
        0.03845,0.96424,0.90108,0.90438,0.05940,0.41880,0.28606,0.49021,0.82102,0.88961,
        0.50421,0.41584,0.53213,0.91810,0.82165,0.70205,0.02575,0.06027,0.92307,0.12477,
        0.61751,0.50223,0.60558,0.28878,0.87444,0.96638,0.30995,0.33031,0.55375,0.28921,
        0.23549,0.99514,0.10846,0.00924,0.87562,0.87474,0.45114,0.66847,0.55827,0.52545,
        0.11701,0.30052,0.97859,0.04447,0.57398,0.75604,0.77095,0.43104,0.19022,0.09857,
        0.88314,0.72244,0.28843,0.29341,0.88762,0.46205,0.79153,0.80758,0.39314,0.52992,
        0.19564,0.54082,0.40443,0.74651,0.99404,0.71522,0.81871,0.94630,0.21986,0.96583,
        0.24464,0.41026,0.47517,0.89472,0.98272,0.64495,0.67087,0.77784,0.31583,0.50083,
        0.71432,0.94712,0.22418,0.53345,0.55049,0.60942,0.26126,0.32867,0.28803,0.50938,
        0.60554,0.23659,0.62247,0.89522,0.23735,0.58888,0.40708,0.70424,0.78098,0.01022,
        0.01545,0.74925,0.79949,0.87691,0.09016,0.95759,0.23262,0.32452,0.37850,0.39120,
        0.22801,0.46126,0.61860,0.85907,0.83179,0.60462,0.85867,0.42284,0.87642,0.42676,
        0.16672,0.99176,0.93232,0.86716,0.42022,0.50492,0.37405,0.55142,0.75224,0.90670,
        0.45293,0.24089,0.27496,0.23572,0.76491,0.53035,0.90147,0.66800,0.65568,0.60966,
        0.44328,0.28176,0.91503,0.40990,0.67357,0.64442,0.57761,0.86607,0.71534,0.06155,
        0.77012,0.34536,0.93858,0.47301,0.32249,0.51403,0.53213,0.53323,0.29574,0.04550,
        0.05377,0.37084,0.66984,0.60859,0.55563,0.88673,0.18185,0.51721,0.33264,0.22042,
        0.70814,0.27123,0.94786,0.19136,0.64392,0.97353,0.95137,0.10458,0.44926,0.26893,
        0.62833,0.29957,0.90257,0.01837,0.18703,0.21677,0.63130,0.39533,0.02916,0.55763,
        0.17370,0.47114,0.13220,0.32239,0.16663,0.64224,0.11783,0.12402,0.25131,0.44466,
        0.28052,0.19695,0.94236,0.39970,0.70666,0.94642,0.01486,0.53957,0.62763,0.71695,
        0.93019,0.17306,0.31885,0.69786,0.44332,0.26852,0.18217,0.52916,0.81263,0.55517,
        0.13051,0.22304,0.96788,0.07351,0.03116,0.47407,0.58274,0.44204,0.75816,0.29547,
        0.24544,0.54944,0.35453,0.18944,0.82432,0.73032,0.91129,0.73622,0.68475,0.73750,
        0.03317,0.56949,0.62956,0.98471,0.17959,0.19513,0.30738,0.60129,0.74506,0.00575,
        0.36135,0.81376,0.47414,0.14519,0.77555,0.04930,0.69409,0.58520,0.71704,0.94223,
        0.89237,0.89086,0.66867,0.11677,0.36593,0.67152,0.80090,0.21837,0.02617,0.64124,
        0.34087,0.17036,0.95574,0.54527,0.16216,0.04425,0.98266,0.94871,0.94140,0.24886,
        0.36198,0.02874,0.00574,0.96768,0.63725,0.06388,0.42993,0.90324,0.89103,0.27125,
        0.03269,0.42372,0.88843,0.00772,0.66885,0.14929,0.06708,0.12068,0.61734,0.86426,
        0.93394,0.41146,0.92454,0.39615,0.19185,0.75706,0.27824,0.76382,0.83762,0.42529,
        0.35973,0.46406,0.54867,0.51396,0.64982,0.24004,0.90682,0.24636,0.34883,0.05447,
        0.39537,0.06343,0.41201,0.27683,0.64953,0.06715,0.69839,0.28600,0.14067,0.39035,
        0.88458,0.78881,0.33103,0.49471,0.10472,0.15930,0.34846,0.23189,0.24342,0.01508,
        0.39951,0.74182,0.43062,0.06432,0.46459,0.90795,0.56579,0.98065,0.30011,0.14062,
        0.63326,0.69305,0.41058,0.71825,0.16141,0.01395,0.44703,0.77965,0.42539,0.97123,
        0.43899,0.33197,0.89664,0.55843,0.37315,0.31497,0.00165,0.87209,0.89476,0.84563,
        0.46860,0.76685,0.32682,0.25630,0.41229,0.22560,0.77718,0.43505,0.83636,0.61629,
        0.83516,0.27871,0.41611,0.88637,0.24701,0.77707,0.26622,0.53227,0.00354,0.36090,
        0.89477,0.87358,0.47322,0.66705,0.69804,0.76026,0.57079,0.80069,0.16049,0.34613,
        0.46394,0.50757,0.38979,0.97285,0.98952,0.40857,0.73913,0.52635,0.77616,0.59446,
        0.04719,0.85081,0.05128,0.43006,0.46071,0.93560,0.24864,0.37573,0.89561,0.62647,
        0.82591,0.99763,0.93938,0.55484,0.15264,0.10924,0.40114,0.82746,0.93473,0.16312,
        0.77493,0.77376,0.40493,0.59494,0.59802,0.70938,0.42707,0.81119,0.05778,0.24146,
        0.73770,0.90731,0.22921,0.11541,0.77961,0.00481,0.00954,0.98213,0.96980,0.30404,
        0.15745,0.75137,0.78821,0.56341,0.84120,0.38896,0.77391,0.73643,0.75357,0.11429,
        0.37157,0.92462,0.16088,0.95955,0.58417,0.63754,0.21923,0.56299,0.55640,0.59020,
        0.51328,0.88618,0.53875,0.91373,0.05104,0.26879,0.16356,0.70712,0.88281,0.86406,
        0.60196,0.31541,0.10321,0.03471,0.96475,0.58448,0.24238,0.73099,0.26033,0.61275,
        0.95555,0.22142,0.32919,0.19698,0.48002,0.80171,0.43737,0.25229,0.54413,0.26823,
        0.62996,0.97598,0.28522,0.01009,0.52129,0.41994,0.26139,0.54733,0.92939,0.43852,
        0.82711,0.22256,0.65050,0.68640,0.98283,0.53975,0.71311,0.45555,0.30644,0.33602,
        0.65110,0.66074,0.72733,0.57105,0.69232,0.20978,0.71350,0.02353,0.27124,0.32779,
        0.90812,0.59529,0.94371,0.14405,0.37384,0.24103,0.60655,0.99526,0.38140,0.76535,
        0.90664,0.45117,0.11405,0.85841,0.86143,0.02630,0.74961,0.77803,0.00711,0.90568,
        0.12941,0.02813,0.84057,0.78333,0.62655,0.23212,0.92798,0.08862,0.88555,0.15484,
        0.81530,0.45889,0.82113,0.48773,0.79510,0.30592,0.63619,0.57906,0.65930,0.71926,
        0.64703,0.76524,0.79872,0.75124,0.38888,0.33837,0.39819,0.33667,0.81509,0.47206,
        0.01985,0.71401,0.40088,0.61935,0.56749,0.23596,0.61561,0.99552,0.48105,0.88355,
        0.53710,0.76347,0.02358,0.63128,0.34752,0.45015,0.69112,0.04988,0.07225,0.94039,
        0.10210,0.17877,0.20149,0.11768,0.20335,0.75220,0.76914,0.85167,0.26836,0.32095,
        0.05394,0.56798,0.95672,0.67567,0.31525,0.07855,0.65428,0.24864,0.87909,0.69929,
        ];
    </script>

    <script type="text/javascript">
        // --------------------------------
        // Decode the URL parameters - fill in the text boxes on the page for any parameter sent in the query string.
        //
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++)
        {
            var pair = vars[i].split("=");
            if ( pair[0] != null && pair[0] != "")
            {
                var v = document.getElementById( pair[0] );
                if ( v != null )
                {
                    if ( v.type == "checkbox" )
                        v.checked = pair[1] == 'true';
                    // else if ( v.type == "radio" )
                    //     setRadioValue(pair[0],pair[1]);
                    else
                        v.value = decodeURIComponent(pair[1]);
                }
            }
        }

        // ---------------------------------------------------------------------------------------
        // Run new_compute to get things rolling
//        new_compute();
//        setTimeout(inputChanged, 2000);
        inputChanged();

    </script>


    <script type="text/javascript" src="https://www.google-analytics.com/analytics.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-22354155-3', 'auto');
      ga('send', 'pageview');

    </script>

    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <!-- <script type="text/javascript">google.load('visualization', '1', {packages: ['corechart']});</script> -->

    </body>
 </html>
 
 
